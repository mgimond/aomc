[
  {
    "objectID": "input/spf/REAMDE.html",
    "href": "input/spf/REAMDE.html",
    "title": "AOMC Model Documentation",
    "section": "",
    "text": "This folder houses SPF files from different sources. They are formatted for the aomc model.\nWhen copying an SPF file to your project folder, be sure to rename the file spf.inp since the input file names are hard coded in aomc."
  },
  {
    "objectID": "input/spf/REAMDE.html#referecenses",
    "href": "input/spf/REAMDE.html#referecenses",
    "title": "AOMC Model Documentation",
    "section": "Referecenses",
    "text": "Referecenses\n\nMobley, C.D., Gentili, B., Gordon, H.R., Jin, Z., Kattawar, G.W., Morel, A., Reinersmam, P., Stamnes, K., Stavn, R.H., 1993. Comparison of numerical models for computing underwater light fields. Applied Optics 32 (36), 7484–7504"
  },
  {
    "objectID": "input_docs/abs_inp.html",
    "href": "input_docs/abs_inp.html",
    "title": "Specific Absorption Coefficient Input Parameters (abs.inp)",
    "section": "",
    "text": "This document describes the format for the abs.inp file, which defines the wavelength-dependent specific absorption coefficients for the various water quality constituents simulated by the AOMC model. For consistent calculation of bulk optical properties, the specific absorption coefficients must be provided in units of \\(m^2/per\\ unit\\ of\\ weight\\) (e.g., \\(m^2/mg\\)). Therefore, it is crucial that the corresponding constituent concentrations in the conc.inp file are consistently recorded as the same weight per unit volume (e.g., \\(mg/m^3\\)).\n\n\nThe structure of the abs.inp file is strict and must conform to the following rules for the model to parse it correctly:\n\nNumber of Wavebands: The very first value in the file must be an integer representing the total number of wavebands. This number must match the value specified for parameter 18) Number of wavebands in the amc.inp file.\nAbsorption Coefficients: Following the number of wavebands, the file must contain a matrix of absorption coefficient values.\n\nRows: The number of rows in this matrix must match the number of wavebands declared on the first line.\nColumns: The number of columns must match the number of system constituents specified in parameter 3) number of system constituents in the amc.inp file. Each column represents a constituent (e.g., pure water, phytoplankton, non-algal particles, DOM).\nData Format: The numerical values are read in free-format (list-directed). This means the numbers should be separated by spaces or commas. They do not need to be aligned in fixed columns, as long as each line contains the correct number of values.\n\nAdditional Information: Any text or data placed after the absorption coefficient matrix is ignored by the model. This space can be used for comments, notes, or metadata, as shown in the example below.\n\n\n\n\nHere is a sample abs.inp file configured for 12 wavebands and 3 system constituents.\n12\n0.0049  0.032  0.004\n0.0051  0.033  0.004\n0.0058  0.035  0.004\n0.0125  0.040  0.004\n0.0210  0.046  0.004\n0.0380  0.052  0.004\n0.0510  0.058  0.004\n0.0620  0.061  0.004\n0.0810  0.063  0.004\n0.1090  0.062  0.004\n0.1550  0.059  0.004\n0.2220  0.051  0.004\n\n--- NOTES ---\nThis section is not read by the AOMC model.\nThe columns represent the following constituents:\n1. Pure Water\n2. Phytoplankton\n3. Non-Algal Particles\nData sourced from internal lab measurements, 2023."
  },
  {
    "objectID": "input_docs/abs_inp.html#file-format",
    "href": "input_docs/abs_inp.html#file-format",
    "title": "Specific Absorption Coefficient Input Parameters (abs.inp)",
    "section": "",
    "text": "The structure of the abs.inp file is strict and must conform to the following rules for the model to parse it correctly:\n\nNumber of Wavebands: The very first value in the file must be an integer representing the total number of wavebands. This number must match the value specified for parameter 18) Number of wavebands in the amc.inp file.\nAbsorption Coefficients: Following the number of wavebands, the file must contain a matrix of absorption coefficient values.\n\nRows: The number of rows in this matrix must match the number of wavebands declared on the first line.\nColumns: The number of columns must match the number of system constituents specified in parameter 3) number of system constituents in the amc.inp file. Each column represents a constituent (e.g., pure water, phytoplankton, non-algal particles, DOM).\nData Format: The numerical values are read in free-format (list-directed). This means the numbers should be separated by spaces or commas. They do not need to be aligned in fixed columns, as long as each line contains the correct number of values.\n\nAdditional Information: Any text or data placed after the absorption coefficient matrix is ignored by the model. This space can be used for comments, notes, or metadata, as shown in the example below."
  },
  {
    "objectID": "input_docs/abs_inp.html#example",
    "href": "input_docs/abs_inp.html#example",
    "title": "Specific Absorption Coefficient Input Parameters (abs.inp)",
    "section": "",
    "text": "Here is a sample abs.inp file configured for 12 wavebands and 3 system constituents.\n12\n0.0049  0.032  0.004\n0.0051  0.033  0.004\n0.0058  0.035  0.004\n0.0125  0.040  0.004\n0.0210  0.046  0.004\n0.0380  0.052  0.004\n0.0510  0.058  0.004\n0.0620  0.061  0.004\n0.0810  0.063  0.004\n0.1090  0.062  0.004\n0.1550  0.059  0.004\n0.2220  0.051  0.004\n\n--- NOTES ---\nThis section is not read by the AOMC model.\nThe columns represent the following constituents:\n1. Pure Water\n2. Phytoplankton\n3. Non-Algal Particles\nData sourced from internal lab measurements, 2023."
  },
  {
    "objectID": "input_docs/scat_inp.html",
    "href": "input_docs/scat_inp.html",
    "title": "Specific Scattering Coefficient Input Parameters (scat.inp)",
    "section": "",
    "text": "This document describes the format for the scat.inp file, which defines the wavelength-dependent specific scattering coefficients for the various water quality constituents simulated by the AOMC model. For consistent calculation of bulk optical properties, the specific scattering coefficients must be provided in units of \\(m^2/per\\ unit\\ of\\ weight\\) (e.g., \\(m^2/mg\\)). Therefore, it is crucial that the corresponding constituent concentrations in the conc.inp file are consistently recorded as the same weight per unit volume (e.g., \\(mg/m^3\\)).\n\n\nThe structure of the scat.inp file is strict and must conform to the following rules for the model to parse it correctly:\n\nNumber of Wavebands: The very first value in the file must be an integer representing the total number of wavebands. This number must match the value specified for parameter 18) Number of wavebands in the amc.inp file.\nScattering Coefficients: Following the number of wavebands, the file must contain a matrix of specific scattering coefficient values.\n\nRows: The number of rows in this matrix must match the number of wavebands declared on the first line.\nColumns: The number of columns must match the number of system constituents specified in parameter 3) number of system constituents in the amc.inp file. Each column represents a constituent (e.g., pure water, phytoplankton, non-algal particles, CDOM).\nData Format: The numerical values are read in free-format (list-directed). This means the numbers should be separated by spaces or commas. They do not need to be aligned in fixed columns, as long as each line contains the correct number of values.\n\nAdditional Information: Any text or data placed after the specific scattering coefficient matrix is ignored by the model. This space can be used for comments, notes, or metadata, as shown in the example below.\n\n\n\n\nHere is a sample scat.inp file configured for 12 wavebands and 3 system constituents.\n12\n0.020   0.50   0.10\n0.019   0.48   0.10\n0.018   0.45   0.10\n0.015   0.40   0.10\n0.012   0.35   0.09\n0.009   0.30   0.08\n0.007   0.25   0.07\n0.005   0.20   0.06\n0.003   0.15   0.05\n0.002   0.10   0.04\n0.001   0.08   0.03\n0.001   0.06   0.02\n\n--- NOTES ---\nThis section is not read by the AOMC model.\nThe columns represent the following constituents:\n1. Pure Water\n2. Phytoplankton\n3. Non-Algal Particles\nData sourced from internal lab measurements, 2023."
  },
  {
    "objectID": "input_docs/scat_inp.html#file-format",
    "href": "input_docs/scat_inp.html#file-format",
    "title": "Specific Scattering Coefficient Input Parameters (scat.inp)",
    "section": "",
    "text": "The structure of the scat.inp file is strict and must conform to the following rules for the model to parse it correctly:\n\nNumber of Wavebands: The very first value in the file must be an integer representing the total number of wavebands. This number must match the value specified for parameter 18) Number of wavebands in the amc.inp file.\nScattering Coefficients: Following the number of wavebands, the file must contain a matrix of specific scattering coefficient values.\n\nRows: The number of rows in this matrix must match the number of wavebands declared on the first line.\nColumns: The number of columns must match the number of system constituents specified in parameter 3) number of system constituents in the amc.inp file. Each column represents a constituent (e.g., pure water, phytoplankton, non-algal particles, CDOM).\nData Format: The numerical values are read in free-format (list-directed). This means the numbers should be separated by spaces or commas. They do not need to be aligned in fixed columns, as long as each line contains the correct number of values.\n\nAdditional Information: Any text or data placed after the specific scattering coefficient matrix is ignored by the model. This space can be used for comments, notes, or metadata, as shown in the example below."
  },
  {
    "objectID": "input_docs/scat_inp.html#example",
    "href": "input_docs/scat_inp.html#example",
    "title": "Specific Scattering Coefficient Input Parameters (scat.inp)",
    "section": "",
    "text": "Here is a sample scat.inp file configured for 12 wavebands and 3 system constituents.\n12\n0.020   0.50   0.10\n0.019   0.48   0.10\n0.018   0.45   0.10\n0.015   0.40   0.10\n0.012   0.35   0.09\n0.009   0.30   0.08\n0.007   0.25   0.07\n0.005   0.20   0.06\n0.003   0.15   0.05\n0.002   0.10   0.04\n0.001   0.08   0.03\n0.001   0.06   0.02\n\n--- NOTES ---\nThis section is not read by the AOMC model.\nThe columns represent the following constituents:\n1. Pure Water\n2. Phytoplankton\n3. Non-Algal Particles\nData sourced from internal lab measurements, 2023."
  },
  {
    "objectID": "input_docs/rad_out.html",
    "href": "input_docs/rad_out.html",
    "title": "rad.out",
    "section": "",
    "text": "The rad.out file stores the radiance distribution for each simulated wavelength. The file is organized into blocks, with each block corresponding to a single wavelength.\nIt’s important to note that the wavelength values are not explicitly written in the rad.out file. To identify which wavelength corresponds to each data block, you must refer to the lambbot.inp file, which lists the wavelengths in the same order as they are processed and outputted.\nEach block in rad.out is structured as follows:\n\nHeader Row: Each block begins with a header row that lists the azimuthal (phi) angles in degrees at which the radiance is recorded. The first column is labeled Angle(deg).\nDepth Sub-blocks: Following the header, the file is divided into sub-blocks for each depth layer, identified by a line such as Depth: 0.0000 m. Note that there are two depth entries for 0 m. The first represents the radiance just above the air-water interface, while the second represents the radiance just below it.\n\nWithin each depth sub-block:\n\nThe first column represents the zenith angle (alpha) in degrees, and these values correspond to the center of each bin.\nThe subsequent columns contain the radiance values corresponding to each azimuthal (phi) angle listed in the header."
  },
  {
    "objectID": "input_docs/theory.html",
    "href": "input_docs/theory.html",
    "title": "AOMC: Radiative Transfer Theory",
    "section": "",
    "text": "This document provides a summary of the theoretical basis for the AOMC model.\n\n\nThe propagation of light through an aquatic medium is governed by the Radiative Transfer Equation (RTE). The RTE accounts for the various ways light can be absorbed and scattered as it interacts with water and its dissolved and particulate constituents. The key to solving the RTE lies in characterizing the Inherent Optical Properties (IOPs) of the medium. IOPs are properties that depend only on the substances in the medium, not on the ambient light field.\n\n\n\nThe primary IOPs that determine the fate of light are:\n\n\n\nAbsorption Coefficient (\\(a\\)): The fraction of radiant energy absorbed by the medium per unit path length (units: m⁻¹).\nScattering Coefficient (\\(b\\)): The fraction of radiant energy scattered by the medium per unit path length (units: m⁻¹).\n\nThese two properties combine to form the beam attenuation coefficient (\\(c\\)), which represents the total loss of energy from a light beam due to both absorption and scattering: \\[\nc(\\lambda) = a(\\lambda) + b(\\lambda)\n\\]\nThe single-scattering albedo (\\(\\omega_0\\)) describes the probability that a photon will be scattered rather than absorbed upon interaction: \\[\n\\omega_0(\\lambda) = \\frac{b(\\lambda)}{c(\\lambda)}\n\\]\n\n\n\nFor a medium containing multiple constituents (e.g., pure water, phytoplankton, sediments), the bulk IOPs are the sum of the contributions from each constituent. The contribution of each constituent is its concentration (\\(C_i\\)) multiplied by its specific absorption or scattering coefficient (\\(a_i^*\\) or \\(b_i^*\\)).\nThe bulk absorption coefficient is given by: \\[ a(\\lambda) = a_w(\\lambda) + \\sum_{i=1}^{N} a_i^*(\\lambda)C_i \\] The bulk scattering coefficient is given by: \\[ b(\\lambda) = b_w(\\lambda) + \\sum_{i=1}^{N} b_i^*(\\lambda)C_i \\] where the subscript \\(w\\) refers to pure water and \\(i\\) refers to the i-th constituent.\n\n\n\n\nWhile the scattering coefficient \\(b\\) describes the total amount of scattering, the Volume Scattering Function (VSF), \\(\\beta(\\psi, \\lambda)\\), describes the angular distribution of the scattered light. It is defined as the radiant intensity scattered from a small volume element in a given direction \\(\\psi\\) per unit of incident irradiance (units: m⁻¹ sr⁻¹).\nThe scattering coefficient \\(b\\) is the integral of the VSF over all solid angles: \\[ b(\\lambda) = 2\\pi \\int_{0}^{\\pi} \\beta(\\psi, \\lambda) \\sin(\\psi) d\\psi \\] A normalized version of the VSF, known as the scattering phase function (\\(\\tilde{\\beta}\\)), gives the probability distribution of a scattering event at a given angle: \\[ \\tilde{\\beta}(\\psi, \\lambda) = \\frac{\\beta(\\psi, \\lambda)}{b(\\lambda)} \\]"
  },
  {
    "objectID": "input_docs/theory.html#theory-of-radiative-transfer",
    "href": "input_docs/theory.html#theory-of-radiative-transfer",
    "title": "AOMC: Radiative Transfer Theory",
    "section": "",
    "text": "The propagation of light through an aquatic medium is governed by the Radiative Transfer Equation (RTE). The RTE accounts for the various ways light can be absorbed and scattered as it interacts with water and its dissolved and particulate constituents. The key to solving the RTE lies in characterizing the Inherent Optical Properties (IOPs) of the medium. IOPs are properties that depend only on the substances in the medium, not on the ambient light field."
  },
  {
    "objectID": "input_docs/theory.html#inherent-optical-properties-iops",
    "href": "input_docs/theory.html#inherent-optical-properties-iops",
    "title": "AOMC: Radiative Transfer Theory",
    "section": "",
    "text": "The primary IOPs that determine the fate of light are:\n\n\n\nAbsorption Coefficient (\\(a\\)): The fraction of radiant energy absorbed by the medium per unit path length (units: m⁻¹).\nScattering Coefficient (\\(b\\)): The fraction of radiant energy scattered by the medium per unit path length (units: m⁻¹).\n\nThese two properties combine to form the beam attenuation coefficient (\\(c\\)), which represents the total loss of energy from a light beam due to both absorption and scattering: \\[\nc(\\lambda) = a(\\lambda) + b(\\lambda)\n\\]\nThe single-scattering albedo (\\(\\omega_0\\)) describes the probability that a photon will be scattered rather than absorbed upon interaction: \\[\n\\omega_0(\\lambda) = \\frac{b(\\lambda)}{c(\\lambda)}\n\\]\n\n\n\nFor a medium containing multiple constituents (e.g., pure water, phytoplankton, sediments), the bulk IOPs are the sum of the contributions from each constituent. The contribution of each constituent is its concentration (\\(C_i\\)) multiplied by its specific absorption or scattering coefficient (\\(a_i^*\\) or \\(b_i^*\\)).\nThe bulk absorption coefficient is given by: \\[ a(\\lambda) = a_w(\\lambda) + \\sum_{i=1}^{N} a_i^*(\\lambda)C_i \\] The bulk scattering coefficient is given by: \\[ b(\\lambda) = b_w(\\lambda) + \\sum_{i=1}^{N} b_i^*(\\lambda)C_i \\] where the subscript \\(w\\) refers to pure water and \\(i\\) refers to the i-th constituent."
  },
  {
    "objectID": "input_docs/theory.html#the-volume-scattering-function-vsf",
    "href": "input_docs/theory.html#the-volume-scattering-function-vsf",
    "title": "AOMC: Radiative Transfer Theory",
    "section": "",
    "text": "While the scattering coefficient \\(b\\) describes the total amount of scattering, the Volume Scattering Function (VSF), \\(\\beta(\\psi, \\lambda)\\), describes the angular distribution of the scattered light. It is defined as the radiant intensity scattered from a small volume element in a given direction \\(\\psi\\) per unit of incident irradiance (units: m⁻¹ sr⁻¹).\nThe scattering coefficient \\(b\\) is the integral of the VSF over all solid angles: \\[ b(\\lambda) = 2\\pi \\int_{0}^{\\pi} \\beta(\\psi, \\lambda) \\sin(\\psi) d\\psi \\] A normalized version of the VSF, known as the scattering phase function (\\(\\tilde{\\beta}\\)), gives the probability distribution of a scattering event at a given angle: \\[ \\tilde{\\beta}(\\psi, \\lambda) = \\frac{\\beta(\\psi, \\lambda)}{b(\\lambda)} \\]"
  },
  {
    "objectID": "input_docs/conc_inp.html",
    "href": "input_docs/conc_inp.html",
    "title": "Concentration Input Parameters (conc.inp)",
    "section": "",
    "text": "This document describes the format for the conc.inp file, which specifies the concentrations of various water quality constituents, the refractive index of the medium, and the top boundary depth for each defined layer in the AOMC model.\nThe weight units (e.g., grams, milligrams, micrograms) used for constituent concentrations in conc.inp must precisely match the weight units specified for the specific absorption coefficients in abs.inp and specific scattering coefficients in scat.inp. For example, \\(mg/m^3\\) or \\(g/m^3\\).\n\n\nThe structure of the conc.inp file is strict and must conform to the following rules for the model to parse it correctly:\n\nNumber of Layers: The very first value in the file must be an integer representing the total number of concentration-dependent layers. This number must match the value specified for parameter 13) # of concentration dependent layers in the amc.inp file.\nLayer Data: Following the number of layers, the file must contain one line of data for each layer. Each line comprises a series of floating-point values:\n\nConcentrations: A series of values representing the concentrations of each system constituent. The number of concentration values on each line must match the value specified for parameter 3) number of system constituents in the amc.inp file.\nRefractive Index: Immediately following the constituent concentrations, a single value representing the refractive index of the medium for that layer.\nTop Boundary Depth: Finally, a single value representing the depth of the top boundary of that layer.\n\nData Format: The numerical values are read in free-format (list-directed). This means the numbers should be separated by spaces or commas. They do not need to be aligned in fixed columns, as long as each line contains the correct total number of values ([number of constituents] + 2).\nAdditional Information: Any text or data placed after the layer data lines is ignored by the model. This space can be used for comments, notes, or metadata, as shown in the example below.\n\n\n\n\nHere is a sample conc.inp file configured for 2 layers and 3 system constituents.\n2\n1.0 0.05 0.01 1.340 0.0\n0.8 0.10 0.02 1.340 1.0\n\n--- NOTES ---\nThis NOTES section is not read by the AOMC model.\nEach line of data (after the first line) represents a layer.\nFor each layer, the values are:\n[Conc. Constituent 1] [Conc. Constituent 2] [Conc. Constituent 3] [Refractive Index] [Top Boundary Depth]\n\nDepths are in meters."
  },
  {
    "objectID": "input_docs/conc_inp.html#file-format",
    "href": "input_docs/conc_inp.html#file-format",
    "title": "Concentration Input Parameters (conc.inp)",
    "section": "",
    "text": "The structure of the conc.inp file is strict and must conform to the following rules for the model to parse it correctly:\n\nNumber of Layers: The very first value in the file must be an integer representing the total number of concentration-dependent layers. This number must match the value specified for parameter 13) # of concentration dependent layers in the amc.inp file.\nLayer Data: Following the number of layers, the file must contain one line of data for each layer. Each line comprises a series of floating-point values:\n\nConcentrations: A series of values representing the concentrations of each system constituent. The number of concentration values on each line must match the value specified for parameter 3) number of system constituents in the amc.inp file.\nRefractive Index: Immediately following the constituent concentrations, a single value representing the refractive index of the medium for that layer.\nTop Boundary Depth: Finally, a single value representing the depth of the top boundary of that layer.\n\nData Format: The numerical values are read in free-format (list-directed). This means the numbers should be separated by spaces or commas. They do not need to be aligned in fixed columns, as long as each line contains the correct total number of values ([number of constituents] + 2).\nAdditional Information: Any text or data placed after the layer data lines is ignored by the model. This space can be used for comments, notes, or metadata, as shown in the example below."
  },
  {
    "objectID": "input_docs/conc_inp.html#example",
    "href": "input_docs/conc_inp.html#example",
    "title": "Concentration Input Parameters (conc.inp)",
    "section": "",
    "text": "Here is a sample conc.inp file configured for 2 layers and 3 system constituents.\n2\n1.0 0.05 0.01 1.340 0.0\n0.8 0.10 0.02 1.340 1.0\n\n--- NOTES ---\nThis NOTES section is not read by the AOMC model.\nEach line of data (after the first line) represents a layer.\nFor each layer, the values are:\n[Conc. Constituent 1] [Conc. Constituent 2] [Conc. Constituent 3] [Refractive Index] [Top Boundary Depth]\n\nDepths are in meters."
  },
  {
    "objectID": "input_docs/comparison.html",
    "href": "input_docs/comparison.html",
    "title": "Model Verification",
    "section": "",
    "text": "Data used in the following simulations can be found in this repository’s ./comparison folder."
  },
  {
    "objectID": "input_docs/comparison.html#a-simple-relationship",
    "href": "input_docs/comparison.html#a-simple-relationship",
    "title": "Model Verification",
    "section": "A Simple Relationship",
    "text": "A Simple Relationship\n./comparison/simple_relationship\nA widely published relationship between irradiance reflectance (just beneath the air–water interface) and the IOPs \\(a\\) and \\(b\\) is expressed as (Gordon et al., 1975; Morel and Prieur, 1977; Kirk, 1981b; Sathyendranath and Platt, 1997):\n\\[\nR = r_p \\frac{b_b}{a}\n\\] where \\(r_p\\) is a dimensionless parameter and \\(b_b=bB\\) (where \\(B\\) represents the fraction of light scattered in the backward direction and is directly calculated from the SPF). The relationship is valid only for optically deep waters whose backscattering coefficient is much less than the absorption coefficient (Morel and Prieur, 1977). Typical values of \\(r_p\\) range between 0.3244 and 0.343.\nThe AOMC model is run using eight different scattering coefficients ranging from 0 to 30 m-1. The average of Petzold’s (1972) three San Diego Harbor SPFs is used for these simulations. The averaged SPF results in a \\(B\\) value of 0.01787. The absorption coefficient is fixed at 1 m-1 yielding a range of \\(b_b/a\\) ratio values between 0 and 0.57. The light source is assumed 100% collimated at a sun zenith angle of 0°. The resulting reflectance values are plotted against the \\(b_b/a\\) ratios and a regression line is fitted to the data with the slope taken to be the coefficient \\(r_p\\).\n\n\n\nSimple relationship\n\n\nThe resulting coefficient of 0.325 is in very good agreement with the published results.\n\nComparison between the coefficient \\(r_p\\) relating the subsurface reflectance R with the IOPs for a nadir solar angle.\n\n\nAuthor(s)\nrp\n\n\n\n\nGordon et al. (1975)\n0.3244\n\n\nMorel and Prieur (1977)\n0.33\n\n\nKirk (1981)\n0.328\n\n\nSathyendranath and Platt (1997)\n0.343\n\n\nAOMC\n0.325"
  },
  {
    "objectID": "input_docs/comparison.html#mobley-et-al.s-canonical-problems",
    "href": "input_docs/comparison.html#mobley-et-al.s-canonical-problems",
    "title": "Model Verification",
    "section": "Mobley et al.’s canonical problems",
    "text": "Mobley et al.’s canonical problems\nThe most comprehensive published model–model comparison in aquatic optics to date involves seven different models that were developed using different numerical techniques and assumptions (Mobley et al., 1993). Mobley et al. (1993) developed several canonical problems that differed in the depth and optical characteristics of the aquatic medium. Subsets of these problems (problems 1, 2 and 6) are compared with the AOMC model.\n\nModel setup\nStandard Configuration used by Mobley et al. divides the polar angle range (\\(0 \\le \\theta \\le 180^{\\circ}\\), or equivalently \\(-1 \\le \\mu \\le 1\\)) into 20 bands of uniform cosine width \\(\\Delta\\mu = 0.1\\).\n\nPolar Cap Note: This uniform spacing results in a polar cap (the first and last bins) with a half-angle of roughly \\(\\theta = 25.8^{\\circ}\\) (\\(\\mu\\) from \\(0.9\\) to \\(1.0\\)). The paper notes that this \\(25.8^{\\circ}\\) cap is “much larger than one would normally use in computing the nadir or zenith radiances.” Consequently, for some specific runs, the model was adjusted to use a “slightly different \\(\\mu\\) spacing and smaller polar caps” to improve accuracy near the vertical, but the authors do not give additional details on this.\n\nFor azimuthal resolution (\\(\\phi\\) bins), the model typically uses 24 bands of uniform width \\(\\Delta\\phi = 15^{\\circ}\\).\nthe relationship between optical depth and geometric depth is defined as follows:\n\nGeometric depth (\\(z\\)): This is the physical depth measured in meters, positive downward from the mean sea surface.\nOptical depth (\\(\\tau\\)): This is a nondimensional quantity defined as the integral of the total attenuation coefficient \\(c\\) over the geometric depth \\(z\\). The formula is given as: \\(\\tau = \\int{c(z)dz}\\)\n\nIf the total attenuation coefficient c is constant with depth (i.e., the water is homogeneous), this simplifies to: \\(\\tau = c * z\\) where c is is the total attenuation coefficient (in units of inverse meters, m⁻¹). Therefore, optical depth represents the number of attenuation lengths from the surface to a given geometric depth. The AOMC model reports the optical properties as a function of depth in meters or \\(z = \\tau / c\\).\n\n\nMobley et al’s Problem 1\n./comparison/mobley1\nMobley et al.’s (1993) first problem uses a Rayleigh scattering phase function to describe the angular scattering properties of the water. The simulated water body is assumed optically deep and the sun’s zenith angle is 60° with an impinging planar irradiance at the surface of 0.5 W m-2 nm-1 . A single wavelength is assumed for this and all subsequent problems. Two different scattering to absorption ratios are used for this problem: 0.25/1.0 and 9.0/1.0. These ratios result in a scattering albedo \\(\\omega = b/(b+a)\\) of 0.2 and 0.9. Mobley et al. present the results of the model comparisons as coefficient of variance (\\(CV\\)) computed as \\(CV=\\frac{standard\\ deviation}{sample\\ mean}\\).\nThe results from the AOMC model are compared to Mobley et al.’s mean output using the relative difference (\\(RD\\)) computed as \\(RD=\\frac{Mobley - AOMC}{Mobley}\\).\n\n\nProblem 1 \\(\\omega\\) = 0.2\n\n\naop\ndepth\nvalue_mob\nvalue_aomc\nCV\nRD\n\n\n\n\nEd\n0.8\n1.41e-01\n0.1417322\n000.10%\n-00.52%\n\n\nEd\n4.0\n1.07e-03\n0.0010764\n000.50%\n-00.59%\n\n\nEd\n8.0\n2.90e-06\n0.0000031\n010.20%\n-05.12%\n\n\nEou\n0.8\n1.34e-02\n0.0131229\n000.30%\n002.07%\n\n\nEou\n4.0\n1.00e-04\n0.0000978\n003.90%\n002.21%\n\n\nEou\n8.0\n3.00e-07\n0.0000003\n030.80%\n013.33%\n\n\nLu\n0.8\n1.72e-03\n0.0016992\n004.40%\n001.21%\n\n\nLu\n4.0\n1.37e-05\n0.0000126\n028.80%\n007.88%\n\n\nLu\n8.0\n0.00e+00\n0.0000000\n019.70%\n011.50%\n\n\n\n\n\n\nProblem 1 \\(\\omega\\) = 0.9\n\n\naop\ndepth\nvalue_mob\nvalue_aomc\nCV\nRD\n\n\n\n\nEd\n0.1\n0.366000\n0.3667542\n000.20%\n-00.21%\n\n\nEd\n0.5\n0.043300\n0.0439224\n000.30%\n-01.44%\n\n\nEd\n1.0\n0.003160\n0.0032414\n001.50%\n-02.58%\n\n\nEou\n0.1\n0.372000\n0.3694564\n000.50%\n000.68%\n\n\nEou\n0.5\n0.043500\n0.0437006\n000.70%\n-00.46%\n\n\nEou\n1.0\n0.003200\n0.0032164\n003.80%\n-00.51%\n\n\nLu\n0.1\n0.048500\n0.0488547\n001.50%\n-00.73%\n\n\nLu\n0.5\n0.005590\n0.0058264\n005.20%\n-04.23%\n\n\nLu\n1.0\n0.000437\n0.0004287\n009.10%\n001.89%\n\n\n\n\nFor nearly all quantities at most depths, the relative difference (RD) between the AOMC model and the reference models is within the inter-model variability (CV). The agreement is particularly strong in the highly scattering case (\\(\\omega\\) = 0.9). In the highly absorbing case (\\(\\omega\\) = 0.2), the relative differences increase slightly, especially at greater depths, but this is expected. Monte Carlo models inherently have greater statistical noise in absorbing waters and at greater depths, a pattern also reflected in the higher CV values in the Mobley paper for these same conditions.\n\n\n\nAOMC model vs. Mobley et al.’s Figure 2a showing Ed, Eou and Lu above the water surface and at various depths. The AOMC model is in good agreement with the reference model.\n\n\n\n\nMobley et al’s Problem 2\n./comparison/mobley2\nThis problem substitutes the Rayleigh VSF with a VSF typical of waters with high particulate matter. This results in a strong forward component to the VSF leading to a probability of forward scatter of around 98%. To reduce the Lu and Ld polar cap solid angles, the number of polar angle bins in the AOMC model was increased to 48.\n\n\nProblem 2 \\(\\omega\\)=0.2\n\n\naop\ndepth\nvalue_mob\nvalue_aomc\nCV\nRD\n\n\n\n\nEd\n0.8\n1.62e-01\n0.1621385\n000.00%\n-00.09%\n\n\nEd\n4.0\n2.27e-03\n0.0022769\n000.20%\n-00.30%\n\n\nEd\n8.0\n1.30e-05\n0.0000129\n004.70%\n000.62%\n\n\nEou\n0.8\n9.66e-04\n0.0009193\n002.30%\n004.84%\n\n\nEou\n4.0\n1.37e-05\n0.0000136\n006.30%\n000.36%\n\n\nEou\n8.0\n1.00e-07\n0.0000000\n018.70%\n072.53%\n\n\nLu\n0.8\n5.47e-05\n0.0000578\n006.00%\n-05.72%\n\n\nLu\n4.0\n6.00e-07\n0.0000008\n035.50%\n-25.00%\n\n\nLu\n8.0\n0.00e+00\n0.0000000\n024.80%\n100.00%\n\n\n\n\n\n\nProblem 2 \\(\\omega\\) = 0.9\n\n\naop\ndepth\nvalue_mob\nvalue_aomc\nCV\nRD\n\n\n\n\nEd\n0.1\n0.41300\n0.4134626\n000.10%\n-00.11%\n\n\nEd\n0.5\n0.18700\n0.1880715\n000.50%\n-00.57%\n\n\nEd\n1.0\n0.06850\n0.0692971\n001.00%\n-01.16%\n\n\nEou\n0.1\n0.09310\n0.0883605\n002.10%\n005.09%\n\n\nEou\n0.5\n0.04630\n0.0440793\n001.70%\n004.80%\n\n\nEou\n1.0\n0.01650\n0.0157118\n001.40%\n004.78%\n\n\nLu\n0.1\n0.00699\n0.0069280\n006.30%\n000.89%\n\n\nLu\n0.5\n0.00329\n0.0031851\n005.50%\n003.19%\n\n\nLu\n1.0\n0.00121\n0.0011638\n010.90%\n003.81%\n\n\n\n\nThe VSF used in this model scatters light much more strongly in the forward direction. Overall, the AOMC model continues to show very good agreement with the Mobley et al. model suite. Agreement is greatest in the highly scattering case (\\(\\omega\\) = 0.9), the relative difference (RD) for all AOPs is generally low and comparable to the inter-model variability (CV) from the original study. As with Problem 1, the deviation increases with depth and in the upwelling quantities (Eou, Lu), which is expected due to the lower number of photons and higher statistical noise in these scenarios.\nThe largest relative differences appear at the greatest depths for the highly absorbing case (e.g., Eou and Lu at depth=8), where photon counts are extremely low. The high CV values (18-35%) from the Mobley paper for these same conditions show that this was a difficult case for all the models, with significant inter-model disagreement.\nThe AOMC model shows a consistent tendency to slightly underestimate Ed (indicated by negative RD values) and slightly overestimate Eou (positive RD values) relative to the Mobley mean, particularly in the highly scattering (ω=0.9) case. This pattern suggests that the AOMC model’s radiance field \\(L(\\theta)\\) might be slightly more diffuse (less forward-peaked) than the average of the Mobley models. A more diffuse field would result in slightly less energy in the direct downward path (lower Ed) and relatively more energy scattered into the upward hemisphere (higher Eou).\nThe following plot compares the AOMC and Mobley’s radiance \\(L(\\theta)\\) distributions for three different depths. The AOMC model is in good agreement with Mobley’s simulations.\n\n\n\nAOMC model vs. Mobley et al.’s Figure 8\n\n\n\n\nMobley’s Problem 6\n./comparison/mobley6\n\n\nProblem 6 \\(\\omega\\)=0.2\n\n\naop\ndepth\nvalue_mob\nvalue_aomc\nCV\nrd\n\n\n\n\nEd\n0.8\n0.1620000\n0.1621323\n000.00%\n-00.08%\n\n\nEd\n4.0\n0.0022800\n0.0022889\n000.30%\n-00.39%\n\n\nEou\n0.8\n0.0009811\n0.0009413\n001.00%\n004.05%\n\n\nEou\n4.0\n0.0022800\n0.0022765\n000.20%\n000.15%\n\n\nLu\n0.8\n0.0000684\n0.0000682\n002.00%\n000.22%\n\n\nLu\n4.0\n0.0003600\n0.0003652\n001.00%\n-01.45%\n\n\n\n\nThe AOMC model shows good agreement with the mean results from the Mobley et al. study. The relative differences for downwelling irradiance (Ed) are less than 0.4%. The most notable deviations occur in the upwelling light field (Eou and Lu). The largest discrepancy is for the upwelling scalar irradiance (Eou) at 0.8m depth, where the AOMC result is 4.05% lower than the Mobley mean. This relative difference is about four times the coefficient of variation (CV of 1.00%) among the models in the original study, suggesting a difference in model output for this parameter. The upwelling radiance (Lu) at 4.0m depth is 1.45% higher in the AOMC model. This is also slightly larger than the 1.00% CV reported in the paper.\n\n\n\nAOMC model vs. Mobley et al.’s Figure 7\n\n\n\n\nReferences\n\nGordon, H.R., Brown, O.B., Jacobs, M.M., 1975. Computed relationships between the inherent and apparent optical properties of a flat, homogeneous ocean. Applied Optics 14, 417–427.\nMobley, C.D., Gentili, B., Gordon, H.R., Jin, Z., Kattawar, G.W., Morel, A., Reinersmam, P., Stamnes, K., Stavn, R.H., 1993. Comparison of numerical models for computing underwater light fields. Applied Optics 32 (36), 7484–7504\nMorel, A., Prieur, L., 1977. Analysis of variations in ocean color. Limnology and Oceanography 22, 709–722\nKirk, J.T.O., 1981. Monte Carlo study of the nature of the underwater light field in, and the relationships between optical properties of, turbid yellow waters. Australian Journal of Marine Freshwater Research 32, 517–532.\nSathyendranath, S., Platt, T., 1997. Analytical model of ocean color. Applied Optics 36 (12), 2620–2629."
  },
  {
    "objectID": "input_docs/wave_out.html",
    "href": "input_docs/wave_out.html",
    "title": "wave.out",
    "section": "",
    "text": "The wave.out file summarizes key optical properties at the surface for each simulated wavelength, making it particularly useful for remote sensing applications.\nThe file contains the following columns:\n\nwavelength: The wavelength of light in nanometers.\nEu: Upwelling planar irradiance just below the sea surface. It represents the total upward-traveling light energy per unit area at that depth.\nEd: Downwelling planar irradiance just below the sea surface. It represents the total downward-traveling light energy per unit area at that depth.\nR: Remote sensing reflectance, calculated as the ratio of upwelling irradiance to downwelling irradiance (Eu/Ed) just below the surface.\nLu: Upwelling radiance just below the sea surface. This is the upwelling energy confined to a specific solid angle, often what is measured by a satellite or airborne sensor.\nEd(a): Downwelling planar irradiance just above the sea surface.\nLu(a): Upwelling radiance just above the sea surface, also known as the water-leaving radiance."
  },
  {
    "objectID": "input_docs/grid_out.html",
    "href": "input_docs/grid_out.html",
    "title": "Gridded Irradiance Output",
    "section": "",
    "text": "When parameter 14) Number of cells in X-Y direction in amc.inp is set to a value greater than 0, the AOMC model generates spatially-resolved gridded irradiance data. This output is useful for visualizing the 2D distribution of light when light source is other than collimated.\nThe format of this gridded output is controlled by parameter 14b) Output to Surfer format."
  },
  {
    "objectID": "input_docs/grid_out.html#plain-ascii-matrix-format-surfer-0",
    "href": "input_docs/grid_out.html#plain-ascii-matrix-format-surfer-0",
    "title": "Gridded Irradiance Output",
    "section": "1. Plain ASCII Matrix Format (surfer = 0)",
    "text": "1. Plain ASCII Matrix Format (surfer = 0)\nWhen the Surfer format option is turned off (0), the model produces four files, each containing data for all simulated wavelengths and depths in a plain ASCII format.\n\ngrided.out: Gridded Downward Planar Irradiance (\\(E_d\\))\ngrideu.out: Gridded Upward Planar Irradiance (\\(E_u\\))\ngridedo.out: Gridded Downward Scalar Irradiance (\\(E_{od}\\))\ngrideuo.out: Gridded Upward Scalar Irradiance (\\(E_{ou}\\))\n\n\nFile Structure\nAll four grid*.out files share the same structure. They consist of a series of data blocks, where each block represents the spatial distribution of irradiance for a single wavelength at a single depth. The blocks for each wavelength are written sequentially.\nThe depths at which the grids are generated are determined by the settings for parameter 6) Number of depth recording layers in the amc.inp file. Grids are produced for each of these layers, in addition to a grid just above the water surface (layer index -1) and just below it (layer index 0).\n\n\nData Block Structure\nEach data block is composed of a header section followed by a data matrix.\n\nHeader Section\nThe header provides metadata for the subsequent grid. It consists of four lines:\n\nGrid and Run Info: Contains the grid dimensions, wavelength, and depth. GRID [N] LAMBDA [wavelength] nm DEPTH [depth] m\n\n[N]: The number of cells in the X and Y dimensions.\n[wavelength]: The wavelength for this grid, in nanometers.\n[depth]: The depth of the grid, in meters.\n\nX-Axis Extents: The minimum and maximum X coordinates of the grid. XMIN XMAX [min_x] [max_x]\nY-Axis Extents: The minimum and maximum Y coordinates of the grid. YMIN YMAX [min_y] [max_y]\nZ-Value Extents: The minimum and maximum irradiance values found within this specific grid. ZMIN ZMAX [min_irradiance] [max_irradiance]\n\n\n\nData Matrix\nImmediately following the four-line header is the data matrix. This is an N x N grid of floating-point numbers. Each row in the file corresponds to a row in the spatial grid.\n\nExample\nBelow is a conceptual example of a single data block for a 5x5 grid in a grided.out file when surfer = 0.\nGRID           5 LAMBDA   550.000 nm DEPTH     1.000000 m\nXMIN XMAX     -2.500000      2.500000\nYMIN YMAX     -2.500000      2.500000\nZMIN ZMAX    1.10000000E-03    8.50000000E-02\n 1.10000000E-03  1.50000000E-03  1.80000000E-03  1.50000000E-03  1.10000000E-03\n 1.50000000E-03  5.50000000E-02  8.50000000E-02  5.50000000E-02  1.50000000E-03\n 1.80000000E-03  8.50000000E-02  1.20000000E-01  8.50000000E-02  1.80000000E-03\n 1.50000000E-03  5.50000000E-02  8.50000000E-02  5.50000000E-02  1.50000000E-03\n 1.10000000E-03  1.50000000E-03  1.80000000E-03  1.50000000E-03  1.10000000E-03\n\n--- Next data block for a different depth or wavelength would follow ---"
  },
  {
    "objectID": "input_docs/grid_out.html#surfer-ascii-grid-format-surfer-1",
    "href": "input_docs/grid_out.html#surfer-ascii-grid-format-surfer-1",
    "title": "Gridded Irradiance Output",
    "section": "2. Surfer ASCII Grid Format (surfer = 1)",
    "text": "2. Surfer ASCII Grid Format (surfer = 1)\nWhen the Surfer format option is turned on (1), the model produces gridded output for Downward Planar Irradiance (\\(E_d\\)) and Upward Planar Irradiance (\\(E_u\\)) only.\nInstead of appending all data to a single file, the model creates a separate file for each combination of depth and wavelength.\n\nFile Naming Convention\nThe files are named using the pattern [Type]_[Depth]_[Wavelength].grd.\n\n[Type]: Eu or Ed.\n[Depth]: A code representing the depth layer:\n\n0000a_: Above the water surface (layer -1).\n0000w_: In the water at the surface (layer 0).\n[#####]: A zero-padded integer for subsequent depth layers (e.g., 00001_).\n\n[Wavelength]: A zero-padded integer representing the wavelength multiplied by 1000.\n\nExample Filenames: * Eu_0000a__450000.grd: Upward planar irradiance, above the surface, for wavelength 450.0 nm. * Ed_00001__675000.grd: Downward planar irradiance, at the first depth layer, for wavelength 675.0 nm.\n\n\nFile Structure\nEach .grd file follows the standard Surfer ASCII Grid format, which is compatible with Surfer software from Golden Software and other GIS/visualization tools. The structure is:\n\nLine 1: A 4-character ID DSAA.\nLine 2: The number of grid lines along the X and Y axes (Nx Ny).\nLine 3: The minimum and maximum X values of the grid (Xmin Xmax).\nLine 4: The minimum and maximum Y values of the grid (Ymin Ymax).\nLine 5: The minimum and maximum Z (irradiance) values in the grid (Zmin Zmax).\nSubsequent Lines: The grid data, written one row at a time, with values for each column in that row separated by spaces."
  },
  {
    "objectID": "input_docs/iop_out.html",
    "href": "input_docs/iop_out.html",
    "title": "iop.out",
    "section": "",
    "text": "The iop.out file contains the Inherent Optical Properties (IOPs) for each layer of the water column. The file is structured in blocks, with each block corresponding to a specific layer.\nEach block starts with a header that specifies the layer number and its starting depth, for example: Layer = 1 Starting at: 0.00000000 m\nFollowing the header, a table lists the IOPs for each simulated wavelength within that layer. The table includes the following columns:\n\nWavelength: The wavelength of light in nanometers.\nabsorption: The bulk absorption coefficient (a) of the water for that layer and wavelength. This value represents the fraction of energy absorbed per unit distance.\nscattering: The bulk scattering coefficient (b) of the water for that layer and wavelength. This value represents the fraction of energy scattered out of the beam per unit distance.\nattenuation: The beam attenuation coefficient (c), which is the sum of the absorption and scattering coefficients (c = a + b).\nscat albedo: The single-scattering albedo (ω), calculated as the ratio of scattering to attenuation (ω = b / c). It represents the probability that a photon will be scattered rather than absorbed."
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "AOMC Model Documentation",
    "section": "",
    "text": "AOMC Illustration (Created by N.A.G.)"
  },
  {
    "objectID": "index.html#what-is-the-aomc-model",
    "href": "index.html#what-is-the-aomc-model",
    "title": "AOMC Model Documentation",
    "section": "What is the AOMC model?",
    "text": "What is the AOMC model?\nThe Aquatic Optics Monte Carlo (AOMC) model is an open-source tool designed to simulate the propagation of light in an optically shallow, vertically heterogeneous aquatic medium. It was originally developed in 2003 using strict FORTRAN 90 standards to ensure broad compatibility across different computing platforms.\nFor more on the project’s history, author, and citation guidelines, please see the About page.\n\nAOMC GitHub Repository"
  },
  {
    "objectID": "index.html#what-will-the-model-simulate",
    "href": "index.html#what-will-the-model-simulate",
    "title": "AOMC Model Documentation",
    "section": "What will the model simulate?",
    "text": "What will the model simulate?\nThe model simulates radiometric quantities (as measured by radiometers) such as:\n\nUpwelling and downwelling scalar and planar irradiances (Euo, Edo, Eu and Ed)\nRadiance\nMean cosines\nShape factors (as used in the two-flow or two-stream model)\nSurface Albedo\n\nA detailed description of the underlying radiative transfer theory can be found in the Model Theory document and the Model Implementation document."
  },
  {
    "objectID": "index.html#how-do-i-compile-the-code",
    "href": "index.html#how-do-i-compile-the-code",
    "title": "AOMC Model Documentation",
    "section": "How do I compile the code?",
    "text": "How do I compile the code?\nCompilation instructions can be found on the Compilation page."
  },
  {
    "objectID": "index.html#running-the-model",
    "href": "index.html#running-the-model",
    "title": "AOMC Model Documentation",
    "section": "Running the model",
    "text": "Running the model\nTo run the aomc model, execute the compiled aomc executable from within a project folder that contains all the necessary input files. It is crucial to note that the input file names (e.g., amc.inp, abs.inp) are hard-coded into the model’s source code. Therefore, these files must be present in the directory from which the model is executed.\nCareful attention must be paid to the format and content of these input files. Incorrect formatting or missing data will lead to errors. It is highly recommended to thoroughly read the Input File Documentation to ensure proper setup."
  },
  {
    "objectID": "index.html#input-file-documentation",
    "href": "index.html#input-file-documentation",
    "title": "AOMC Model Documentation",
    "section": "Input File Documentation",
    "text": "Input File Documentation\nThe AOMC model is configured through a series of plain text input files. Detailed documentation for the format of each file can be found below:\n\namc.inp: Main model configuration.\nabs.inp: Specific absorption coefficients.\nscat.inp: Specific scattering coefficients.\nconc.inp: Constituent concentrations by layer.\nspf.inp: Scattering phase function definitions.\nlambbot.inp: Wavelength and bottom reflectance properties.\ndifcol.inp: Direct vs. diffuse light fractions (used when lsource=0).\nskydist.inp: Tabulated sky radiance data (used when lsource=1)."
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About the AOMC Project",
    "section": "",
    "text": "The Aquatic Optics Monte Carlo (AOMC) model is an open-source tool designed to simulate the propagation of light in an optically shallow, vertically heterogeneous aquatic medium. It was originally developed in 2003 using strict FORTRAN 90 standards to ensure broad compatibility across different computing platforms.\nThe primary motivation behind AOMC was to provide researchers and students with a flexible and transparent tool for exploring radiative transfer theory in aquatic environments. While the model has not been in active development since 2003, its core physics and Monte Carlo engine remain a valuable resource for educational and research purposes."
  },
  {
    "objectID": "about.html#about-the-model",
    "href": "about.html#about-the-model",
    "title": "About the AOMC Project",
    "section": "",
    "text": "The Aquatic Optics Monte Carlo (AOMC) model is an open-source tool designed to simulate the propagation of light in an optically shallow, vertically heterogeneous aquatic medium. It was originally developed in 2003 using strict FORTRAN 90 standards to ensure broad compatibility across different computing platforms.\nThe primary motivation behind AOMC was to provide researchers and students with a flexible and transparent tool for exploring radiative transfer theory in aquatic environments. While the model has not been in active development since 2003, its core physics and Monte Carlo engine remain a valuable resource for educational and research purposes."
  },
  {
    "objectID": "about.html#author",
    "href": "about.html#author",
    "title": "About the AOMC Project",
    "section": "Author",
    "text": "Author\nThe AOMC model was created and is maintained by Manuel Gimond.\n\nGitHub Profile: github.com/mgimond"
  },
  {
    "objectID": "about.html#how-to-cite",
    "href": "about.html#how-to-cite",
    "title": "About the AOMC Project",
    "section": "How to Cite",
    "text": "How to Cite\nIf you use this model or its source code in your research, please cite the following publication:\n\nGimond M., 2004. Description and verification of an aquatic optics Monte Carlo model. Environmental Modelling and Software, vol 19, n. 12, pp 1065-1076."
  },
  {
    "objectID": "about.html#license",
    "href": "about.html#license",
    "title": "About the AOMC Project",
    "section": "License",
    "text": "License\nThe AOMC source code is open source and available under the MIT License. You can view the full license file here."
  },
  {
    "objectID": "about.html#contact-and-support",
    "href": "about.html#contact-and-support",
    "title": "About the AOMC Project",
    "section": "Contact and Support",
    "text": "Contact and Support\nPlease note that this project is not actively maintained. Support is very limited.\nFor bug reports, questions, or suggestions, the preferred method is to open an issue on the AOMC GitHub repository’s issue tracker."
  },
  {
    "objectID": "input_docs/compilation.html",
    "href": "input_docs/compilation.html",
    "title": "Compiling the AOMC Fortran Code",
    "section": "",
    "text": "This document provides instructions on how to compile the Fortran source code for the AOMC project using the gfortran compiler. All source code is located in the src/ directory.\nThe compilation should be run from the root directory of the project.\n\n\nA build.sh script is provided to automate the entire compilation process. To compile the model, simply run the script from the project’s root directory:\n./build.sh\nThis will compile the necessary files in order, create the aomc executable in the root directory, and clean up the intermediate object (.o) and module (.mod) files.\n\n\n\nIf you prefer to compile the files manually, follow these steps from the root directory.\n\n\nFirst, compile the files that define the modules. This will create global.o, modules.o, and the corresponding .mod files in your root directory.\ngfortran -c src/global.f90 src/modules.f90\n\n\n\nNext, compile the rest of the source files. The compiler will use the .mod files created in the previous step.\ngfortran -c src/geom2.f90 src/interface.f90 src/light_internal.f90 src/logbin.f90 src/mc.f90 src/vsf.f90 src/water.f90\n\n\n\nFinally, link all the generated object files (.o) together to create the executable named aomc in the root directory.\ngfortran -o aomc *.o\n\n\n\nYou can remove the intermediate files.\nrm *.o *.mod\n\n\n\n\nFor reference, this is the content of the build.sh script:\n#!/bin/bash\n# A script to compile the AOMC Fortran project.\n\n# Exit immediately if a command exits with a non-zero status.\nset -e\n\n# Compiler\nFC=gfortran\n\n# List of source files, now in the src/ directory\nMODULE_FILES=\"src/global.f90 src/modules.f90\"\nSOURCE_FILES=\"src/geom2.f90 src/interface.f90 src/light_internal.f90 src/logbin.f90 src/mc.f90 src/vsf.f90 src/water.f90\"\nALL_OBJECTS=\"\"\n\necho \"Compiling modules...\"\n$FC -c $MODULE_FILES\nALL_OBJECTS+=$(basename --multiple $MODULE_FILES | sed 's/\\.f90/\\.o/g')\n\necho \"Compiling other sources...\"\n$FC -c $SOURCE_FILES\nALL_OBJECTS+=\" \"$(basename --multiple $SOURCE_FILES | sed 's/\\.f90/\\.o/g')\n\necho \"Linking...\"\n$FC -o aomc $ALL_OBJECTS\n\necho \"Cleaning up intermediate files...\"\nrm *.o *.mod\n\necho \"Build complete! Executable 'aomc' is ready in the root directory.\""
  },
  {
    "objectID": "input_docs/compilation.html#automated-build-script-recommended",
    "href": "input_docs/compilation.html#automated-build-script-recommended",
    "title": "Compiling the AOMC Fortran Code",
    "section": "",
    "text": "A build.sh script is provided to automate the entire compilation process. To compile the model, simply run the script from the project’s root directory:\n./build.sh\nThis will compile the necessary files in order, create the aomc executable in the root directory, and clean up the intermediate object (.o) and module (.mod) files."
  },
  {
    "objectID": "input_docs/compilation.html#manual-compilation",
    "href": "input_docs/compilation.html#manual-compilation",
    "title": "Compiling the AOMC Fortran Code",
    "section": "",
    "text": "If you prefer to compile the files manually, follow these steps from the root directory.\n\n\nFirst, compile the files that define the modules. This will create global.o, modules.o, and the corresponding .mod files in your root directory.\ngfortran -c src/global.f90 src/modules.f90\n\n\n\nNext, compile the rest of the source files. The compiler will use the .mod files created in the previous step.\ngfortran -c src/geom2.f90 src/interface.f90 src/light_internal.f90 src/logbin.f90 src/mc.f90 src/vsf.f90 src/water.f90\n\n\n\nFinally, link all the generated object files (.o) together to create the executable named aomc in the root directory.\ngfortran -o aomc *.o\n\n\n\nYou can remove the intermediate files.\nrm *.o *.mod"
  },
  {
    "objectID": "input_docs/compilation.html#build.sh-script-content",
    "href": "input_docs/compilation.html#build.sh-script-content",
    "title": "Compiling the AOMC Fortran Code",
    "section": "",
    "text": "For reference, this is the content of the build.sh script:\n#!/bin/bash\n# A script to compile the AOMC Fortran project.\n\n# Exit immediately if a command exits with a non-zero status.\nset -e\n\n# Compiler\nFC=gfortran\n\n# List of source files, now in the src/ directory\nMODULE_FILES=\"src/global.f90 src/modules.f90\"\nSOURCE_FILES=\"src/geom2.f90 src/interface.f90 src/light_internal.f90 src/logbin.f90 src/mc.f90 src/vsf.f90 src/water.f90\"\nALL_OBJECTS=\"\"\n\necho \"Compiling modules...\"\n$FC -c $MODULE_FILES\nALL_OBJECTS+=$(basename --multiple $MODULE_FILES | sed 's/\\.f90/\\.o/g')\n\necho \"Compiling other sources...\"\n$FC -c $SOURCE_FILES\nALL_OBJECTS+=\" \"$(basename --multiple $SOURCE_FILES | sed 's/\\.f90/\\.o/g')\n\necho \"Linking...\"\n$FC -o aomc $ALL_OBJECTS\n\necho \"Cleaning up intermediate files...\"\nrm *.o *.mod\n\necho \"Build complete! Executable 'aomc' is ready in the root directory.\""
  },
  {
    "objectID": "input_docs/aop_out.html",
    "href": "input_docs/aop_out.html",
    "title": "aop.out",
    "section": "",
    "text": "The aop.out file contains the Apparent Optical Properties (AOPs) computed by the Monte Carlo simulation. The file contains a table of AOPs at various depths. The output is structured in blocks, one for each wavelength defined in lambbot.inp.\nThe table has the following columns:\n\ndepth (m): The depth at which the AOPs are calculated. The first depth = 0 represents the values at the water surface. The second depth = 0 represents the values just below the air/water interface.\nEu: Upward planar irradiance. This is the total upward-flowing light energy across a horizontal plane.\nEd: Downward planar irradiance. This is the total downward-flowing light energy across a horizontal plane.\nE: Net planar irradiance, calculated as Ed - Eu.\nR*: Irradiance reflectance, calculated as Eu / Ed.\nEou: Upward scalar irradiance. This is the total upward-flowing light energy from all directions at a point.\nEod: Downward scalar irradiance. This is the total downward-flowing light energy from all directions at a point.\nmeancosUP: Average cosine for upward irradiance, calculated as Eu / Eou. It represents the average direction of the upward light field.\nmeancosDown: Average cosine for downward irradiance, calculated as Ed / Eod. It represents the average direction of the downward light field.\nmeancos: Average cosine for the total light field, calculated as (Ed - Eu) / (Eod + Eou).\nrd: Diffuse attenuation coefficient for downward irradiance.\nrup: Diffuse attenuation coefficient for upward irradiance.\nLd: Downward radiance in the polar direction (0 degrees).\nLu: Upward radiance in the nadir direction (180 degrees).\n\nEach block of output for a given wavelength is terminated by the line: * The above water reflectance is actually an albedo calculation"
  },
  {
    "objectID": "input_docs/lambbot_inp.html",
    "href": "input_docs/lambbot_inp.html",
    "title": "Wavelength and Bottom Reflectance Input (lambbot.inp)",
    "section": "",
    "text": "This document describes the format for the lambbot.inp file. This file is crucial for defining the simulation’s wavebands and the reflective properties of the bottom boundary (and an optional target).\n\n\nThe structure of the lambbot.inp file depends on whether a bottom target is enabled via parameter 16) Bottom target: NO[0],YES[1] in the amc.inp file.\nThe data is read in free-format (list-directed), meaning numerical values should be separated by spaces or commas.\n\n\nIf no target is specified, the file has the following structure:\n\nFirst Line: An integer representing the total number of wavebands. This must match parameter 18) Number of wavebands in amc.inp.\nSubsequent Lines: One line for each waveband, containing 3 values:\n\nWavelength: The actual wavelength value (e.g., in nanometers).\nBottom Reflectance: The fraction of photons that are reflected by the bottom boundary (a value from 0.0 to 1.0).\nBottom Specular Fraction: The fraction of the reflected photons that are reflected specularly (mirror-like). A value of 1.0 is purely specular, 0.0 is purely diffuse (Lambertian).\n\n\n\n\n\nIf a target is specified, the file requires additional information:\n\nFirst Line: An integer representing the total number of wavebands (must match amc.inp).\nSubsequent Lines: One line for each waveband, containing 5 values:\n\nWavelength: The actual wavelength value.\nBottom Reflectance: Reflectance of the general bottom area (outside the target).\nBottom Specular Fraction: Specular fraction for the general bottom.\nTarget Reflectance: Reflectance of the target area.\nTarget Specular Fraction: Specular fraction for the target.\n\n\n\n\n\n\nWhen a photon strikes the bottom boundary, the model determines its fate using the parameters from this file in a two-step process:\n\nReflection vs. Absorption: A random number (from 0 to 1) is generated. If this number is less than or equal to the surface’s Reflectance value (e.g., Bottom Reflectance), the photon is reflected. Otherwise, it is absorbed.\nSpecular vs. Diffuse: If the photon is reflected, a second random number is generated.\n\nIf this second random number is less than or equal to the surface’s Specular Fraction value (e.g., Bottom Specular Fraction), the reflection is specular (mirror-like), and the photon’s angle of incidence is perfectly inverted.\nIf the random number is greater than the Specular Fraction, the reflection is diffuse (Lambertian), and the photon is scattered in a new, random upward direction.\n\n\n\n\n\n\n\nHere is a sample lambbot.inp for 4 wavebands without a bottom target.\n4\n400.0   0.10   0.5\n500.0   0.15   0.4\n600.0   0.20   0.3\n700.0   0.25   0.2\n\n--- NOTES ---\nThis section is not read by the model.\nFormat: [Wavelength] [Bottom Reflectance] [Bottom Specular Fraction]\n\n\n\nHere is a sample lambbot.inp for 4 wavebands with a bottom target enabled.\n4\n400.0   0.10   0.5   0.8   1.0\n500.0   0.15   0.4   0.7   0.9\n600.0   0.20   0.3   0.6   0.8\n700.0   0.25   0.2   0.5   0.7\n\n--- NOTES ---\nThis section is not read by the model.\nFormat: [Wavelength] [Bottom Reflectance] [Bottom Specular] [Target Reflectance] [Target Specular]"
  },
  {
    "objectID": "input_docs/lambbot_inp.html#file-format",
    "href": "input_docs/lambbot_inp.html#file-format",
    "title": "Wavelength and Bottom Reflectance Input (lambbot.inp)",
    "section": "",
    "text": "The structure of the lambbot.inp file depends on whether a bottom target is enabled via parameter 16) Bottom target: NO[0],YES[1] in the amc.inp file.\nThe data is read in free-format (list-directed), meaning numerical values should be separated by spaces or commas.\n\n\nIf no target is specified, the file has the following structure:\n\nFirst Line: An integer representing the total number of wavebands. This must match parameter 18) Number of wavebands in amc.inp.\nSubsequent Lines: One line for each waveband, containing 3 values:\n\nWavelength: The actual wavelength value (e.g., in nanometers).\nBottom Reflectance: The fraction of photons that are reflected by the bottom boundary (a value from 0.0 to 1.0).\nBottom Specular Fraction: The fraction of the reflected photons that are reflected specularly (mirror-like). A value of 1.0 is purely specular, 0.0 is purely diffuse (Lambertian).\n\n\n\n\n\nIf a target is specified, the file requires additional information:\n\nFirst Line: An integer representing the total number of wavebands (must match amc.inp).\nSubsequent Lines: One line for each waveband, containing 5 values:\n\nWavelength: The actual wavelength value.\nBottom Reflectance: Reflectance of the general bottom area (outside the target).\nBottom Specular Fraction: Specular fraction for the general bottom.\nTarget Reflectance: Reflectance of the target area.\nTarget Specular Fraction: Specular fraction for the target."
  },
  {
    "objectID": "input_docs/lambbot_inp.html#specular-vs.-diffuse-reflection-logic",
    "href": "input_docs/lambbot_inp.html#specular-vs.-diffuse-reflection-logic",
    "title": "Wavelength and Bottom Reflectance Input (lambbot.inp)",
    "section": "",
    "text": "When a photon strikes the bottom boundary, the model determines its fate using the parameters from this file in a two-step process:\n\nReflection vs. Absorption: A random number (from 0 to 1) is generated. If this number is less than or equal to the surface’s Reflectance value (e.g., Bottom Reflectance), the photon is reflected. Otherwise, it is absorbed.\nSpecular vs. Diffuse: If the photon is reflected, a second random number is generated.\n\nIf this second random number is less than or equal to the surface’s Specular Fraction value (e.g., Bottom Specular Fraction), the reflection is specular (mirror-like), and the photon’s angle of incidence is perfectly inverted.\nIf the random number is greater than the Specular Fraction, the reflection is diffuse (Lambertian), and the photon is scattered in a new, random upward direction."
  },
  {
    "objectID": "input_docs/lambbot_inp.html#examples",
    "href": "input_docs/lambbot_inp.html#examples",
    "title": "Wavelength and Bottom Reflectance Input (lambbot.inp)",
    "section": "",
    "text": "Here is a sample lambbot.inp for 4 wavebands without a bottom target.\n4\n400.0   0.10   0.5\n500.0   0.15   0.4\n600.0   0.20   0.3\n700.0   0.25   0.2\n\n--- NOTES ---\nThis section is not read by the model.\nFormat: [Wavelength] [Bottom Reflectance] [Bottom Specular Fraction]\n\n\n\nHere is a sample lambbot.inp for 4 wavebands with a bottom target enabled.\n4\n400.0   0.10   0.5   0.8   1.0\n500.0   0.15   0.4   0.7   0.9\n600.0   0.20   0.3   0.6   0.8\n700.0   0.25   0.2   0.5   0.7\n\n--- NOTES ---\nThis section is not read by the model.\nFormat: [Wavelength] [Bottom Reflectance] [Bottom Specular] [Target Reflectance] [Target Specular]"
  },
  {
    "objectID": "input_docs/spf_inp.html",
    "href": "input_docs/spf_inp.html",
    "title": "Scattering Phase Function Input (spf.inp)",
    "section": "",
    "text": "This document describes the format for the spf.inp file, which provides the cumulative scattering phase function (SPF) for each water constituent. This data determines the new direction of a photon after a scattering event.\n\n\nThe structure of the spf.inp file is as follows:\n\nNumber of Angles: The very first value must be an integer representing the number of angles in the phase function table. This number must match the value for parameter 12a) Number of angles in amc.inp.\nCumulative SPF Table: Following the first line, the file must contain one line for each angle. Each line is read in free-format (space- or comma-separated) and contains N+1 values, where N is the number of constituents (from amc.inp parameter 3):\n\nColumn 1: The scattering angle in radians.\nColumn 2 to N+1: The cumulative scattering probability for each constituent, from 0.0 to 1.0. Each column corresponds to a constituent in the same order they are defined elsewhere in the model.\n\n\n\n\n\nWhen a photon is scattered, the model uses the data from spf.inp to determine its new direction in a two-step process:\n\nSelect the Scattering Particle: First, the model randomly determines which type of particle (constituent) caused the scattering. This is based on the relative scattering contribution of each constituent at that wavelength.\nDetermine the New Angle: Once a particle is chosen, the model uses its corresponding cumulative SPF column as a probability lookup table to find the new scattering angle.\n\nA random number between 0 and 1 is generated.\nThe model finds where this random number would fit within the chosen constituent’s cumulative SPF column, identifying the two consecutive probability values it falls between.\nBy default, the model then assigns the discrete angle associated with the upper boundary of this probability interval. For example, if the random number falls between the probability for 0.1 radians and 0.2 radians, the new scattering angle will be set to 0.2 radians.\n\n\nNote on Interpolation: The vsf.f90 subroutine contains a commented-out (disabled) code block that would perform linear interpolation to calculate a more precise angle within the interval. However, this is not the default behavior. As a result, the slope values calculated when reading spf.inp are not used in the default configuration.\n\n\n\nHere is a sample spf.inp file configured for 5 angles and 2 system constituents.\n5\n0.000   0.000   0.000\n0.785   0.600   0.500\n1.571   0.800   0.750\n2.356   0.950   0.900\n3.142   1.000   1.000\n\n--- NOTES ---\nThis section is not read by the AOMC model.\nFormat: [Angle in Radians] [Constituent 1 Cum. SPF] [Constituent 2 Cum. SPF]"
  },
  {
    "objectID": "input_docs/spf_inp.html#file-format",
    "href": "input_docs/spf_inp.html#file-format",
    "title": "Scattering Phase Function Input (spf.inp)",
    "section": "",
    "text": "The structure of the spf.inp file is as follows:\n\nNumber of Angles: The very first value must be an integer representing the number of angles in the phase function table. This number must match the value for parameter 12a) Number of angles in amc.inp.\nCumulative SPF Table: Following the first line, the file must contain one line for each angle. Each line is read in free-format (space- or comma-separated) and contains N+1 values, where N is the number of constituents (from amc.inp parameter 3):\n\nColumn 1: The scattering angle in radians.\nColumn 2 to N+1: The cumulative scattering probability for each constituent, from 0.0 to 1.0. Each column corresponds to a constituent in the same order they are defined elsewhere in the model."
  },
  {
    "objectID": "input_docs/spf_inp.html#how-the-model-uses-this-file",
    "href": "input_docs/spf_inp.html#how-the-model-uses-this-file",
    "title": "Scattering Phase Function Input (spf.inp)",
    "section": "",
    "text": "When a photon is scattered, the model uses the data from spf.inp to determine its new direction in a two-step process:\n\nSelect the Scattering Particle: First, the model randomly determines which type of particle (constituent) caused the scattering. This is based on the relative scattering contribution of each constituent at that wavelength.\nDetermine the New Angle: Once a particle is chosen, the model uses its corresponding cumulative SPF column as a probability lookup table to find the new scattering angle.\n\nA random number between 0 and 1 is generated.\nThe model finds where this random number would fit within the chosen constituent’s cumulative SPF column, identifying the two consecutive probability values it falls between.\nBy default, the model then assigns the discrete angle associated with the upper boundary of this probability interval. For example, if the random number falls between the probability for 0.1 radians and 0.2 radians, the new scattering angle will be set to 0.2 radians.\n\n\nNote on Interpolation: The vsf.f90 subroutine contains a commented-out (disabled) code block that would perform linear interpolation to calculate a more precise angle within the interval. However, this is not the default behavior. As a result, the slope values calculated when reading spf.inp are not used in the default configuration."
  },
  {
    "objectID": "input_docs/spf_inp.html#example",
    "href": "input_docs/spf_inp.html#example",
    "title": "Scattering Phase Function Input (spf.inp)",
    "section": "",
    "text": "Here is a sample spf.inp file configured for 5 angles and 2 system constituents.\n5\n0.000   0.000   0.000\n0.785   0.600   0.500\n1.571   0.800   0.750\n2.356   0.950   0.900\n3.142   1.000   1.000\n\n--- NOTES ---\nThis section is not read by the AOMC model.\nFormat: [Angle in Radians] [Constituent 1 Cum. SPF] [Constituent 2 Cum. SPF]"
  },
  {
    "objectID": "input_docs/difcol_inp.html",
    "href": "input_docs/difcol_inp.html",
    "title": "Direct vs. Diffuse Light Input Parameters (difcol.inp)",
    "section": "",
    "text": "This document describes the format for the difcol.inp file. This file provides wavelength-dependent data on the fraction of collimated (direct) light and the relative intensity of photons for each waveband.\nImportant: This file is only read by the model if parameter 2) Light source from model(0) or file(1) in amc.inp is set to 0.\n\n\nThe structure of the difcol.inp file is as follows:\n\nNumber of Wavebands: The very first value in the file must be an integer representing the total number of wavebands. This number must match the value specified for parameter 18) Number of wavebands in the amc.inp file.\nLight Fraction and Intensity: Following the number of wavebands, the file must contain one line of data for each waveband. Each line consists of two floating-point values:\n\nDirect Fraction: The first value on the line is the fraction of light that is collimated (direct) for that specific waveband. This should be a value between 0.0 and 1.0.\nRelative Intensity: The second value is a weighting factor for the number of photons to be simulated at that waveband. This factor is multiplied by the total number of iterations (parameter 1) Iterations in amc.inp) to determine the actual number of photons simulated for the waveband.\n\nData Format: The numerical values are read in free-format (list-directed). This means the numbers should be separated by spaces or commas and do not need to be aligned in fixed columns.\n\n\n\n\nHere is a sample difcol.inp file configured for 12 wavebands.\n12\n0.8 1.0\n0.8 1.0\n0.7 1.0\n0.7 0.9\n0.6 0.9\n0.6 0.8\n0.5 0.8\n0.5 0.7\n0.4 0.7\n0.4 0.6\n0.3 0.5\n0.3 0.4\n\n--- NOTES ---\nThis section is not read by the AOMC model.\nEach line of data represents a waveband.\nFor each waveband, the values are:\n[Direct Fraction] [Relative Intensity]"
  },
  {
    "objectID": "input_docs/difcol_inp.html#file-format",
    "href": "input_docs/difcol_inp.html#file-format",
    "title": "Direct vs. Diffuse Light Input Parameters (difcol.inp)",
    "section": "",
    "text": "The structure of the difcol.inp file is as follows:\n\nNumber of Wavebands: The very first value in the file must be an integer representing the total number of wavebands. This number must match the value specified for parameter 18) Number of wavebands in the amc.inp file.\nLight Fraction and Intensity: Following the number of wavebands, the file must contain one line of data for each waveband. Each line consists of two floating-point values:\n\nDirect Fraction: The first value on the line is the fraction of light that is collimated (direct) for that specific waveband. This should be a value between 0.0 and 1.0.\nRelative Intensity: The second value is a weighting factor for the number of photons to be simulated at that waveband. This factor is multiplied by the total number of iterations (parameter 1) Iterations in amc.inp) to determine the actual number of photons simulated for the waveband.\n\nData Format: The numerical values are read in free-format (list-directed). This means the numbers should be separated by spaces or commas and do not need to be aligned in fixed columns."
  },
  {
    "objectID": "input_docs/difcol_inp.html#example",
    "href": "input_docs/difcol_inp.html#example",
    "title": "Direct vs. Diffuse Light Input Parameters (difcol.inp)",
    "section": "",
    "text": "Here is a sample difcol.inp file configured for 12 wavebands.\n12\n0.8 1.0\n0.8 1.0\n0.7 1.0\n0.7 0.9\n0.6 0.9\n0.6 0.8\n0.5 0.8\n0.5 0.7\n0.4 0.7\n0.4 0.6\n0.3 0.5\n0.3 0.4\n\n--- NOTES ---\nThis section is not read by the AOMC model.\nEach line of data represents a waveband.\nFor each waveband, the values are:\n[Direct Fraction] [Relative Intensity]"
  },
  {
    "objectID": "input_docs/spf.html",
    "href": "input_docs/spf.html",
    "title": "Scattering Phase Function Input (spf.inp)",
    "section": "",
    "text": "This document describes the format and theoretical basis for the spf.inp file, which provides the angular scattering information for each water constituent. This data is fundamental to determining the new direction of a photon after a scattering event.\n\n\nThe way a medium scatters light is fundamentally described by two related properties. The scattering functions used in the canonical benchmark problems for aquatic optics models are often derived from the seminal experimental work of Petzold (1972).\n\nVolume Scattering Function (VSF), \\(\\beta(\\psi)\\): This is the core inherent optical property that describes the intensity of light scattered from a volume element into a specific direction or angle, \\(\\psi\\). It has units of m⁻¹ sr⁻¹.\nScattering Phase Function (SPF), \\(\\tilde{\\beta}(\\psi)\\): This is the VSF normalized by the total scattering coefficient, b. The SPF represents the probability density function of a photon being scattered into a particular angle \\(\\psi\\). Its integral over all solid angles is 1. \\[ \\tilde{\\beta}(\\psi) = \\frac{\\beta(\\psi)}{b} \\quad \\text{where} \\quad b = 2\\pi \\int_{0}^{\\pi} \\beta(\\psi) \\sin(\\psi) d\\psi \\]\n\nFor a Monte Carlo model, working with a probability density function (PDF) like the SPF is inefficient. It’s much faster to use the Cumulative Distribution Function (CDF). The spf.inp file contains this pre-calculated CDF, which can be called the Cumulative Scattering Phase Function (CSPF). In his original work, Petzold referred to this as the “Probability Curve” or “Volume Scattering Distribution Function”.\nThe CSPF gives the probability that a photon will be scattered into an angle less than or equal to \\(\\psi\\). It is created by integrating the SPF from 0 up to the angle \\(\\psi\\). A value of CSPF(π) = 1.0 means there is a 100% probability of being scattered to an angle somewhere between 0 and 180 degrees.\nTo determine a new scattering angle, the model uses a technique called inverse transform sampling: 1. A random number, \\(\\xi\\), is generated, uniformly distributed between 0 and 1. 2. The model then inverts the CSPF to find the angle \\(\\psi\\) that corresponds to this cumulative probability: ψ = CSPF⁻¹(ξ).\n\n\n\nThe vsf.f90 subroutine implements the inverse transform sampling described above. It uses two different techniques, following the recommendations of Mobley et al. (1993), to provide high accuracy across all scattering angles.\n\n\nFor the first angular bin in the spf.inp file, which covers the critical small forward-scattering angles, the model uses a power-law extrapolation. This approach is justified because, as noted by Petzold (1972) in his original VSF measurements, the scattering function at very small angles behaves like a power-law (σ(θ) = Cθ^m). This method accurately reproduces the strong, physically-correct forward-scattering peak. The new angle thetascat is calculated as:\nthetascat = spf(1,0) * (random / spf(1,ii))**(1.529052)\nThis formula inverts the cumulative distribution of a ψ^-1.346 power law, providing a highly realistic distribution of scattering angles very close to zero.\n\n\n\nFor all other angular bins, the model uses linear interpolation. After finding which two points in the CSPF table the random number falls between, it calculates the precise angle corresponding to that random number’s proportional distance between the two points.\nfraction  = (random - spf(jj - 1, ii)) / (spf(jj, ii) - spf(jj - 1, ii))\nthetascat = spf(jj - 1, 0) + fraction * (spf(jj, 0) - spf(jj - 1, 0))\nThis ensures a continuous and accurate selection of scattering angles across the rest of the phase function.\n\n\n\n\nThe structure of the spf.inp file is as follows:\n\nNumber of Angles: The very first value must be an integer representing the number of angles in the phase function table. This number must match the value for parameter 12a) Number of angles in amc.inp.\nCumulative SPF Table: Following the first line, the file must contain one line for each angle. Each line is read in free-format (space- or comma-separated) and contains N+1 values, where N is the number of constituents (from amc.inp parameter 3):\n\nColumn 1: The scattering angle in radians.\nColumn 2 to N+1: The cumulative scattering probability for each constituent, from 0.0 to 1.0. Each column corresponds to a constituent in the same order they are defined elsewhere in the model.\n\n\n\n\n\nHere is a sample spf.inp file configured for 5 angles and 2 system constituents.\n5\n0.000   0.000   0.000\n0.785   0.600   0.500\n1.571   0.800   0.750\n2.356   0.950   0.900\n3.142   1.000   1.000\n\n--- NOTES ---\nThis section is not read by the AOMC model.\nFormat: [Angle in Radians] [Constituent 1 Cum. SPF] [Constituent 2 Cum. SPF]\n\n\n\n\nPetzold, T. J. (1972). Volume Scattering Functions for Selected Ocean Waters (SIO Ref. 72-78). Scripps Institution of Oceanography, Visibility Lab."
  },
  {
    "objectID": "input_docs/spf.html#from-vsf-to-a-cumulative-distribution",
    "href": "input_docs/spf.html#from-vsf-to-a-cumulative-distribution",
    "title": "Scattering Phase Function Input (spf.inp)",
    "section": "",
    "text": "The way a medium scatters light is fundamentally described by two related properties. The scattering functions used in the canonical benchmark problems for aquatic optics models are often derived from the seminal experimental work of Petzold (1972).\n\nVolume Scattering Function (VSF), \\(\\beta(\\psi)\\): This is the core inherent optical property that describes the intensity of light scattered from a volume element into a specific direction or angle, \\(\\psi\\). It has units of m⁻¹ sr⁻¹.\nScattering Phase Function (SPF), \\(\\tilde{\\beta}(\\psi)\\): This is the VSF normalized by the total scattering coefficient, b. The SPF represents the probability density function of a photon being scattered into a particular angle \\(\\psi\\). Its integral over all solid angles is 1. \\[ \\tilde{\\beta}(\\psi) = \\frac{\\beta(\\psi)}{b} \\quad \\text{where} \\quad b = 2\\pi \\int_{0}^{\\pi} \\beta(\\psi) \\sin(\\psi) d\\psi \\]\n\nFor a Monte Carlo model, working with a probability density function (PDF) like the SPF is inefficient. It’s much faster to use the Cumulative Distribution Function (CDF). The spf.inp file contains this pre-calculated CDF, which can be called the Cumulative Scattering Phase Function (CSPF). In his original work, Petzold referred to this as the “Probability Curve” or “Volume Scattering Distribution Function”.\nThe CSPF gives the probability that a photon will be scattered into an angle less than or equal to \\(\\psi\\). It is created by integrating the SPF from 0 up to the angle \\(\\psi\\). A value of CSPF(π) = 1.0 means there is a 100% probability of being scattered to an angle somewhere between 0 and 180 degrees.\nTo determine a new scattering angle, the model uses a technique called inverse transform sampling: 1. A random number, \\(\\xi\\), is generated, uniformly distributed between 0 and 1. 2. The model then inverts the CSPF to find the angle \\(\\psi\\) that corresponds to this cumulative probability: ψ = CSPF⁻¹(ξ)."
  },
  {
    "objectID": "input_docs/spf.html#how-aomc-determines-the-scattering-angle",
    "href": "input_docs/spf.html#how-aomc-determines-the-scattering-angle",
    "title": "Scattering Phase Function Input (spf.inp)",
    "section": "",
    "text": "The vsf.f90 subroutine implements the inverse transform sampling described above. It uses two different techniques, following the recommendations of Mobley et al. (1993), to provide high accuracy across all scattering angles.\n\n\nFor the first angular bin in the spf.inp file, which covers the critical small forward-scattering angles, the model uses a power-law extrapolation. This approach is justified because, as noted by Petzold (1972) in his original VSF measurements, the scattering function at very small angles behaves like a power-law (σ(θ) = Cθ^m). This method accurately reproduces the strong, physically-correct forward-scattering peak. The new angle thetascat is calculated as:\nthetascat = spf(1,0) * (random / spf(1,ii))**(1.529052)\nThis formula inverts the cumulative distribution of a ψ^-1.346 power law, providing a highly realistic distribution of scattering angles very close to zero.\n\n\n\nFor all other angular bins, the model uses linear interpolation. After finding which two points in the CSPF table the random number falls between, it calculates the precise angle corresponding to that random number’s proportional distance between the two points.\nfraction  = (random - spf(jj - 1, ii)) / (spf(jj, ii) - spf(jj - 1, ii))\nthetascat = spf(jj - 1, 0) + fraction * (spf(jj, 0) - spf(jj - 1, 0))\nThis ensures a continuous and accurate selection of scattering angles across the rest of the phase function."
  },
  {
    "objectID": "input_docs/spf.html#file-format",
    "href": "input_docs/spf.html#file-format",
    "title": "Scattering Phase Function Input (spf.inp)",
    "section": "",
    "text": "The structure of the spf.inp file is as follows:\n\nNumber of Angles: The very first value must be an integer representing the number of angles in the phase function table. This number must match the value for parameter 12a) Number of angles in amc.inp.\nCumulative SPF Table: Following the first line, the file must contain one line for each angle. Each line is read in free-format (space- or comma-separated) and contains N+1 values, where N is the number of constituents (from amc.inp parameter 3):\n\nColumn 1: The scattering angle in radians.\nColumn 2 to N+1: The cumulative scattering probability for each constituent, from 0.0 to 1.0. Each column corresponds to a constituent in the same order they are defined elsewhere in the model."
  },
  {
    "objectID": "input_docs/spf.html#example",
    "href": "input_docs/spf.html#example",
    "title": "Scattering Phase Function Input (spf.inp)",
    "section": "",
    "text": "Here is a sample spf.inp file configured for 5 angles and 2 system constituents.\n5\n0.000   0.000   0.000\n0.785   0.600   0.500\n1.571   0.800   0.750\n2.356   0.950   0.900\n3.142   1.000   1.000\n\n--- NOTES ---\nThis section is not read by the AOMC model.\nFormat: [Angle in Radians] [Constituent 1 Cum. SPF] [Constituent 2 Cum. SPF]"
  },
  {
    "objectID": "input_docs/spf.html#references",
    "href": "input_docs/spf.html#references",
    "title": "Scattering Phase Function Input (spf.inp)",
    "section": "",
    "text": "Petzold, T. J. (1972). Volume Scattering Functions for Selected Ocean Waters (SIO Ref. 72-78). Scripps Institution of Oceanography, Visibility Lab."
  },
  {
    "objectID": "input_docs/model_implementation.html",
    "href": "input_docs/model_implementation.html",
    "title": "AOMC Model Documentation",
    "section": "",
    "text": "The AOMC model uses the Monte Carlo method to simulate the individual life histories of a large number of photons. By tracking the fate of each photon, the model reconstructs the light field (e.g., radiance and irradiance) throughout the water body.\nThe simulation is driven by the main program mc.f90, which iterates through a predefined number of photons for each specified wavelength.\n\n\nThe mc.f90 program is the central orchestrator of the AOMC model. Its structure is divided into several logical blocks, each responsible for a specific phase of the simulation:\n\nInitialization: Sets up initial variables and seeds the random number generator.\nReading General Parameters: Reads primary simulation parameters from the amc.inp file.\nAllocation of Memory: Dynamically allocates memory for arrays and variables based on the input parameters.\nReading of Input Files: Reads data from various input files, such as conc.inp, abs.inp, scat.inp, spf.inp, lambbot.inp, and difcol.inp or skydist.inp.\nCalculation of IOPs: Computes inherent optical properties like beam attenuation and scattering albedo.\nRun the Model: Executes the core Monte Carlo simulation loop, tracing individual photon paths.\nCompute AOPs: Processes the tallied photon data to calculate apparent optical properties.\nFree Up Allocated Memory: Deallocates all dynamically allocated memory.\n\n\n\n\nThe core of the simulation is a loop where each iteration represents the entire life of a single photon. A new photon is initiated at the start of each iteration, and its path is traced until it is terminated.\n\nInitiation: A new photon’s life begins inside the INTENSITY_LOOP in mc.f90. The light subroutine is called to define its initial properties (e.g., direction), which are determined by the sky radiance distribution. This can be a simple model with direct and diffuse components (difcol.inp) or a tabulated distribution from a file (skydist.inp). The photon is placed at the air-water interface.\nTermination: A photon’s path ends, and the simulation for that photon ceases, when one of the following events occurs, as handled by the water subroutine in water.f90:\n\nIt is absorbed within the water column. This is determined by comparing a random number to the single-scattering albedo.\nIt scatters upward and passes back out through the air-water interface.\nIt hits a side boundary of the model domain.\nIt is absorbed by the bottom boundary.\n\n\nOnce a photon is terminated, the program begins the next iteration of the loop, initiating a new photon.\n\n\n\n\n\n\nWhen the photon strikes the surface, Fresnel’s equation is used with a random number to determine if it is reflected or transmitted into the water.\nIf the photon is transmitted, Snell’s Law is used to calculate its new, refracted angle of travel within the water.\n\n\n\n\n\nThe distance the photon travels between interactions is its optical path length. This step size, \\(\\Delta l\\), is determined probabilistically using the beam attenuation coefficient \\(c(\\lambda)\\) and a random number, \\(\\xi_1\\), uniformly distributed between 0 and 1: \\[ \\Delta l = -\\frac{\\ln(\\xi_1)}{c(\\lambda)} \\]\n\n\n\n\n\nAfter traveling the distance \\(\\Delta l\\), the photon interacts with the medium. A decision is made to either absorb or scatter the photon.\nA new random number, \\(\\xi_2\\), is generated and compared to the single-scattering albedo, \\(\\omega_0(\\lambda)\\).\n\nIf \\(\\xi_2 \\le \\omega_0(\\lambda)\\), the photon is scattered.\nIf \\(\\xi_2 &gt; \\omega_0(\\lambda)\\), the photon is absorbed, and its simulation is terminated.\n\n\n\n\n\nIf the photon is scattered, its direction must change.\n\nSelect Constituent: The model first determines which constituent particle scattered the photon. This is a random choice weighted by the relative scattering contribution of each constituent at that wavelength.\nSelect New Angle: The model then uses the cumulative scattering phase function for that specific particle (from spf.inp) as a probability table. A new random number, \\(\\xi_3\\), is generated to select a new polar scattering angle, \\(\\theta\\). A uniformly distributed random number determines the azimuthal scattering angle, \\(\\phi\\).\n\nFor a detailed review of the scattering phase function see here\n\n\n\n\nIf a photon strikes the bottom boundary, a random number is compared to the bottom reflectance (\\(R_b\\)) from lambbot.inp.\n\nIf absorbed, the photon is terminated.\nIf reflected, another random number determines if the reflection is specular (mirror-like) or diffuse (Lambertian), and the photon’s journey continues in an upward direction.\n\n\n\n\n\n\nAs photons travel through the simulated environment, their crossings of predefined horizontal layers are recorded. This information is used to calculate the Apparent Optical Properties (AOPs).\n\n\n\nThe logbin subroutine (in logbin.f90) is called whenever a photon crosses a logging layer.\nlogbin records the event by incrementing a counter in a large multi-dimensional array n(lambda, i, j, k, t, p). This array acts as a histogram, binning photons by:\n\nlambda: Wavelength.\ni, j: Horizontal grid cell location.\nk: Vertical layer index.\nt, p: Bins for the polar (\\(\\theta\\)) and azimuthal (\\(\\phi\\)) angles of the photon’s direction.\n\n\n\n\n\nThe AOMC model supports two different methods for defining the polar angle bins, controlled by the angint parameter in amc.inp:\n\nEqual Angle Intervals (angint = 1): The polar angle range [0, \\(\\pi\\)] is divided into alphaint bins of equal angular width.\nEqual Cosine Intervals (angint = 0): The cosine of the polar angle range [1, -1] is divided into alphaint equal intervals. This provides higher angular resolution near the horizontal plane (\\(\\theta = \\pi/2\\)) compared to the equal angle method.\n\n\n\n\n\nAfter all photon simulations are complete, the n array contains the raw counts of photon crossings.\nIn the final section of mc.f90, these counts are converted into physical quantities:\n\nRadiance (\\(L\\)): The number of photons in each angular bin is normalized by the solid angle of that bin to calculate radiance. \\[ L = \\frac{N_{photons}}{\\Delta\\Omega} \\]\nIrradiance (\\(E_d, E_u\\)): Planar irradiances are calculated by summing the radiance over the downward or upward hemisphere, respectively, and weighting by the cosine of the polar angle. Scalar irradiances (\\(E_{od}, E_{ou}\\)) are also computed by summing radiance over the hemispheres without the cosine weighting.\n\n\nThis process transforms the statistical data from the Monte Carlo simulation into meaningful optical properties of the light field in the water.\nThe following table summarizes the conversion of the tallied photons in the AOMC model to the final radiometric quantities. \\(N(\\theta,\\phi)\\) represents the number of photon crossings, across a horizontal plane, tallied within the angular bin corresponding to polar angle \\(\\theta\\) and azimuth angle \\(\\phi\\).\n\n\n\n\n\n\n\n\nRadiometric Quantity\nConventional Definition\nDerivation from the AOMC model\n\n\n\n\nField Radiance, \\[L\\]\n\\[\\frac{d^2\\Phi}{dA |\\cos(\\theta)| d\\omega}\\]\n\\[\\frac{N(\\theta,\\phi)}{|\\cos(\\theta)|\\sin(\\theta)d\\theta d\\phi}\\]\n\n\nDownwelling Planar Irradiance \\[E_d\\]\n\\[\\int_0^{2\\pi}\\int_0^{\\pi/2} L(\\theta,\\phi)\\cos(\\theta)\\sin(\\theta)d\\theta d\\phi\\]\n\\[\\sum_0^{2\\pi}\\sum_0^{\\pi/2} N(\\theta,\\phi)\\]\n\n\nUpwelling Planar Irradiance, \\[E_u\\]\n\\[-\\int_0^{2\\pi}\\int_{\\pi/2}^{\\pi} L(\\theta,\\phi)\\cos(\\theta)\\sin(\\theta)d\\theta d\\phi\\]\n\\[\\sum_0^{2\\pi}\\sum_{\\pi/2}^{\\pi} N(\\theta,\\phi)\\]\n\n\nDownwelling Scalar Irradiance, \\[E_od\\]\n\\[\\int_0^{2\\pi}\\int_0^{\\pi/2} L(\\theta,\\phi)\\sin(\\theta)d\\theta d\\phi\\]\n\\[\\sum_0^{2\\pi}\\sum_0^{\\pi/2} \\frac{N(\\theta,\\phi)}{|\\cos(\\theta)|}\\]\n\n\nUpwelling Scalar Irradiance, \\[E_ou\\]\n\\[\\int_0^{2\\pi}\\int_{\\pi/2}^{\\pi} L(\\theta,\\phi)\\sin(\\theta)d\\theta d\\phi\\]\n\\[\\sum_0^{2\\pi}\\sum_{\\pi/2}^{\\pi} \\frac{N(\\theta,\\phi)}{|\\cos(\\theta)|}\\]\n\n\nPolar Radiance, \\[L_d, L_u\\]\n\\[\\frac{d^2\\Phi}{dA |\\cos(\\theta)| d\\omega}, at\\ \\theta=0, \\pi\\]\n\\[\\frac{\\sum_{\\phi=0}^{2\\pi} N_{cap}(\\phi)}{\\int_0^{2\\pi}\\int_{cap} |\\cos(\\theta)|\\sin(\\theta)d\\theta d\\phi}\\]\n\n\n\n\n\n\n\nIt may seem counter-intuitive that the final calculation for planar irradiance (\\(E_d\\) and \\(E_u\\)) is a direct sum of the tallied photon counts \\(N(\\theta, \\phi)\\), while the physical definition of irradiance explicitly includes a cosine factor. This is not an oversight, but a fundamental and elegant property of how photon transport is modeled across horizontal layers in a Monte Carlo simulation. The key is to recognize that the probability of a photon successfully crossing a horizontal detection plane is naturally proportional to the cosine of its zenith angle. An obliquely-traveling photon has a longer path to travel to cross a given vertical distance compared to a photon traveling straight down. Because it travels farther through the water, it has a higher chance of being absorbed or scattered away before it can be tallied.\nThis “survival probability” acts as an inherent, or implicit, cosine weighting on the photon population that reaches the detector. The act of simply summing the weights of the photons that successfully cross the plane has already accounted for the \\(\\cos(\\theta)\\) factor required for planar irradiance. This is also why the scalar irradiance calculation, which sums energy from all directions without a cosine weighting, must computationally remove this implicit factor by dividing the tallied counts \\(N(\\theta, \\phi)\\) by \\(|\\cos(\\theta)|\\)."
  },
  {
    "objectID": "input_docs/model_implementation.html#the-aomc-model-implementation",
    "href": "input_docs/model_implementation.html#the-aomc-model-implementation",
    "title": "AOMC Model Documentation",
    "section": "",
    "text": "The AOMC model uses the Monte Carlo method to simulate the individual life histories of a large number of photons. By tracking the fate of each photon, the model reconstructs the light field (e.g., radiance and irradiance) throughout the water body.\nThe simulation is driven by the main program mc.f90, which iterates through a predefined number of photons for each specified wavelength.\n\n\nThe mc.f90 program is the central orchestrator of the AOMC model. Its structure is divided into several logical blocks, each responsible for a specific phase of the simulation:\n\nInitialization: Sets up initial variables and seeds the random number generator.\nReading General Parameters: Reads primary simulation parameters from the amc.inp file.\nAllocation of Memory: Dynamically allocates memory for arrays and variables based on the input parameters.\nReading of Input Files: Reads data from various input files, such as conc.inp, abs.inp, scat.inp, spf.inp, lambbot.inp, and difcol.inp or skydist.inp.\nCalculation of IOPs: Computes inherent optical properties like beam attenuation and scattering albedo.\nRun the Model: Executes the core Monte Carlo simulation loop, tracing individual photon paths.\nCompute AOPs: Processes the tallied photon data to calculate apparent optical properties.\nFree Up Allocated Memory: Deallocates all dynamically allocated memory.\n\n\n\n\nThe core of the simulation is a loop where each iteration represents the entire life of a single photon. A new photon is initiated at the start of each iteration, and its path is traced until it is terminated.\n\nInitiation: A new photon’s life begins inside the INTENSITY_LOOP in mc.f90. The light subroutine is called to define its initial properties (e.g., direction), which are determined by the sky radiance distribution. This can be a simple model with direct and diffuse components (difcol.inp) or a tabulated distribution from a file (skydist.inp). The photon is placed at the air-water interface.\nTermination: A photon’s path ends, and the simulation for that photon ceases, when one of the following events occurs, as handled by the water subroutine in water.f90:\n\nIt is absorbed within the water column. This is determined by comparing a random number to the single-scattering albedo.\nIt scatters upward and passes back out through the air-water interface.\nIt hits a side boundary of the model domain.\nIt is absorbed by the bottom boundary.\n\n\nOnce a photon is terminated, the program begins the next iteration of the loop, initiating a new photon.\n\n\n\n\n\n\nWhen the photon strikes the surface, Fresnel’s equation is used with a random number to determine if it is reflected or transmitted into the water.\nIf the photon is transmitted, Snell’s Law is used to calculate its new, refracted angle of travel within the water.\n\n\n\n\n\nThe distance the photon travels between interactions is its optical path length. This step size, \\(\\Delta l\\), is determined probabilistically using the beam attenuation coefficient \\(c(\\lambda)\\) and a random number, \\(\\xi_1\\), uniformly distributed between 0 and 1: \\[ \\Delta l = -\\frac{\\ln(\\xi_1)}{c(\\lambda)} \\]\n\n\n\n\n\nAfter traveling the distance \\(\\Delta l\\), the photon interacts with the medium. A decision is made to either absorb or scatter the photon.\nA new random number, \\(\\xi_2\\), is generated and compared to the single-scattering albedo, \\(\\omega_0(\\lambda)\\).\n\nIf \\(\\xi_2 \\le \\omega_0(\\lambda)\\), the photon is scattered.\nIf \\(\\xi_2 &gt; \\omega_0(\\lambda)\\), the photon is absorbed, and its simulation is terminated.\n\n\n\n\n\nIf the photon is scattered, its direction must change.\n\nSelect Constituent: The model first determines which constituent particle scattered the photon. This is a random choice weighted by the relative scattering contribution of each constituent at that wavelength.\nSelect New Angle: The model then uses the cumulative scattering phase function for that specific particle (from spf.inp) as a probability table. A new random number, \\(\\xi_3\\), is generated to select a new polar scattering angle, \\(\\theta\\). A uniformly distributed random number determines the azimuthal scattering angle, \\(\\phi\\).\n\nFor a detailed review of the scattering phase function see here\n\n\n\n\nIf a photon strikes the bottom boundary, a random number is compared to the bottom reflectance (\\(R_b\\)) from lambbot.inp.\n\nIf absorbed, the photon is terminated.\nIf reflected, another random number determines if the reflection is specular (mirror-like) or diffuse (Lambertian), and the photon’s journey continues in an upward direction.\n\n\n\n\n\n\nAs photons travel through the simulated environment, their crossings of predefined horizontal layers are recorded. This information is used to calculate the Apparent Optical Properties (AOPs).\n\n\n\nThe logbin subroutine (in logbin.f90) is called whenever a photon crosses a logging layer.\nlogbin records the event by incrementing a counter in a large multi-dimensional array n(lambda, i, j, k, t, p). This array acts as a histogram, binning photons by:\n\nlambda: Wavelength.\ni, j: Horizontal grid cell location.\nk: Vertical layer index.\nt, p: Bins for the polar (\\(\\theta\\)) and azimuthal (\\(\\phi\\)) angles of the photon’s direction.\n\n\n\n\n\nThe AOMC model supports two different methods for defining the polar angle bins, controlled by the angint parameter in amc.inp:\n\nEqual Angle Intervals (angint = 1): The polar angle range [0, \\(\\pi\\)] is divided into alphaint bins of equal angular width.\nEqual Cosine Intervals (angint = 0): The cosine of the polar angle range [1, -1] is divided into alphaint equal intervals. This provides higher angular resolution near the horizontal plane (\\(\\theta = \\pi/2\\)) compared to the equal angle method.\n\n\n\n\n\nAfter all photon simulations are complete, the n array contains the raw counts of photon crossings.\nIn the final section of mc.f90, these counts are converted into physical quantities:\n\nRadiance (\\(L\\)): The number of photons in each angular bin is normalized by the solid angle of that bin to calculate radiance. \\[ L = \\frac{N_{photons}}{\\Delta\\Omega} \\]\nIrradiance (\\(E_d, E_u\\)): Planar irradiances are calculated by summing the radiance over the downward or upward hemisphere, respectively, and weighting by the cosine of the polar angle. Scalar irradiances (\\(E_{od}, E_{ou}\\)) are also computed by summing radiance over the hemispheres without the cosine weighting.\n\n\nThis process transforms the statistical data from the Monte Carlo simulation into meaningful optical properties of the light field in the water.\nThe following table summarizes the conversion of the tallied photons in the AOMC model to the final radiometric quantities. \\(N(\\theta,\\phi)\\) represents the number of photon crossings, across a horizontal plane, tallied within the angular bin corresponding to polar angle \\(\\theta\\) and azimuth angle \\(\\phi\\).\n\n\n\n\n\n\n\n\nRadiometric Quantity\nConventional Definition\nDerivation from the AOMC model\n\n\n\n\nField Radiance, \\[L\\]\n\\[\\frac{d^2\\Phi}{dA |\\cos(\\theta)| d\\omega}\\]\n\\[\\frac{N(\\theta,\\phi)}{|\\cos(\\theta)|\\sin(\\theta)d\\theta d\\phi}\\]\n\n\nDownwelling Planar Irradiance \\[E_d\\]\n\\[\\int_0^{2\\pi}\\int_0^{\\pi/2} L(\\theta,\\phi)\\cos(\\theta)\\sin(\\theta)d\\theta d\\phi\\]\n\\[\\sum_0^{2\\pi}\\sum_0^{\\pi/2} N(\\theta,\\phi)\\]\n\n\nUpwelling Planar Irradiance, \\[E_u\\]\n\\[-\\int_0^{2\\pi}\\int_{\\pi/2}^{\\pi} L(\\theta,\\phi)\\cos(\\theta)\\sin(\\theta)d\\theta d\\phi\\]\n\\[\\sum_0^{2\\pi}\\sum_{\\pi/2}^{\\pi} N(\\theta,\\phi)\\]\n\n\nDownwelling Scalar Irradiance, \\[E_od\\]\n\\[\\int_0^{2\\pi}\\int_0^{\\pi/2} L(\\theta,\\phi)\\sin(\\theta)d\\theta d\\phi\\]\n\\[\\sum_0^{2\\pi}\\sum_0^{\\pi/2} \\frac{N(\\theta,\\phi)}{|\\cos(\\theta)|}\\]\n\n\nUpwelling Scalar Irradiance, \\[E_ou\\]\n\\[\\int_0^{2\\pi}\\int_{\\pi/2}^{\\pi} L(\\theta,\\phi)\\sin(\\theta)d\\theta d\\phi\\]\n\\[\\sum_0^{2\\pi}\\sum_{\\pi/2}^{\\pi} \\frac{N(\\theta,\\phi)}{|\\cos(\\theta)|}\\]\n\n\nPolar Radiance, \\[L_d, L_u\\]\n\\[\\frac{d^2\\Phi}{dA |\\cos(\\theta)| d\\omega}, at\\ \\theta=0, \\pi\\]\n\\[\\frac{\\sum_{\\phi=0}^{2\\pi} N_{cap}(\\phi)}{\\int_0^{2\\pi}\\int_{cap} |\\cos(\\theta)|\\sin(\\theta)d\\theta d\\phi}\\]\n\n\n\n\n\n\n\nIt may seem counter-intuitive that the final calculation for planar irradiance (\\(E_d\\) and \\(E_u\\)) is a direct sum of the tallied photon counts \\(N(\\theta, \\phi)\\), while the physical definition of irradiance explicitly includes a cosine factor. This is not an oversight, but a fundamental and elegant property of how photon transport is modeled across horizontal layers in a Monte Carlo simulation. The key is to recognize that the probability of a photon successfully crossing a horizontal detection plane is naturally proportional to the cosine of its zenith angle. An obliquely-traveling photon has a longer path to travel to cross a given vertical distance compared to a photon traveling straight down. Because it travels farther through the water, it has a higher chance of being absorbed or scattered away before it can be tallied.\nThis “survival probability” acts as an inherent, or implicit, cosine weighting on the photon population that reaches the detector. The act of simply summing the weights of the photons that successfully cross the plane has already accounted for the \\(\\cos(\\theta)\\) factor required for planar irradiance. This is also why the scalar irradiance calculation, which sums energy from all directions without a cosine weighting, must computationally remove this implicit factor by dividing the tallied counts \\(N(\\theta, \\phi)\\) by \\(|\\cos(\\theta)|\\)."
  },
  {
    "objectID": "input_docs/skydist_inp.html",
    "href": "input_docs/skydist_inp.html",
    "title": "Tabulated Sky Radiance Input (skydist.inp)",
    "section": "",
    "text": "This document describes the format for the skydist.inp file, which allows the user to provide a custom, tabulated sky radiance distribution for the model’s light source.\nImportant: This file is only read by the model if parameter 2) Light source from model(0) or file(1) in amc.inp is set to 1.\n\n\nThe skydist.inp file has a multi-part structure consisting of a header, a list of wavelengths, and a data block of radiance values. The file is read in free-format, meaning all numerical values should be separated by spaces or commas.\n\n\nThe very first line of the file must contain 4 integer values that define the dimensions of the sky data:\n\nnumskyelem: The total number of individual sky radiance data points that will be listed in the data block section of the file.\nsky_zenith: The number of zenith angle bins used in the sky distribution (i.e., the number of divisions from the horizon to the point directly overhead).\nsky_azimuth: The number of azimuthal angle bins. Note that the azimuth index in the data block will range from 0 to this value.\nnumskywave: The number of distinct wavelengths for which sky radiance data is provided.\n\n\n\n\nThe second line of the file must list the actual wavelength values. The number of values on this line must match the numskywave parameter from the header line.\n\n\n\nFollowing the first two lines, the remainder of the file consists of the sky radiance data points. The number of lines in this section must match the numskyelem parameter from the header line.\nEach line in this block represents a single sky “patch” or element and must contain 4 values:\n\nWavelength Index: An integer (1-based) that points to a wavelength in the Wavelengths Line. For example, a value of 1 corresponds to the first wavelength listed.\nZenith Index: An integer (1-based) specifying the zenith angle bin, from 1 to sky_zenith.\nAzimuth Index: An integer (0-based) specifying the azimuth angle bin, from 0 to sky_azimuth.\nRadiance Value: A floating-point number representing the radiance intensity for that specific sky patch.\n\nThis format allows for a sparse representation of the sky; you only need to provide entries for the sky patches that have non-zero radiance.\n\n\n\nAfter reading this file, the AOMC model processes the data for each wavelength by:\n\nSumming all radiance values for that wavelength.\nNormalizing the values so they represent a probability distribution.\nMultiplying this distribution by the total number of iterations (from amc.inp) to determine how many photons should be initiated from each specific sky patch.\n\n\n\n\nIt is not necessary for the wavelengths listed in this file to exactly match the simulation wavebands defined in lambbot.inp. The model does not interpolate the sky data. Instead, for each simulation waveband, the model performs a nearest-neighbor search. It identifies the single, numerically closest wavelength provided in skydist.inp and uses the complete sky radiance distribution from that single entry for the entire simulation run of that waveband.\nFor example, if skydist.inp contains data for 500nm and 600nm, and the simulation is running for wavebands at 520nm, 540nm, and 580nm:\n\nThe 520nm run will use the sky data for 500nm.\nThe 540nm run will also use the sky data for 500nm (since 540 is closer to 500 than to 600).\nThe 580nm run will use the sky data for 600nm.\n\n\n\n\nThe AOMC model expects input files to contain only the required numerical data in the correct order.\n\n\n\n\nBelow is a valid skydist.inp file, followed by an explanation of its contents.\nFile Content:\n6 2 2 2\n550.0 650.0\n1 1 0 10.5\n1 1 1 12.0\n1 2 1 20.0\n2 1 0 8.2\n2 1 1 9.5\n2 2 1 15.3\nExplanation of the Example:\n\nHeader Line (6 2 2 2):\n\n6: There are 6 radiance data lines to read in the data block.\n2: The sky is divided into 2 zenith bins (indexed 1 and 2).\n2: The sky is divided into 3 azimuth bins (indexed 0, 1, and 2).\n2: The file provides data for 2 different wavelengths.\n\nWavelengths Line (550.0 650.0):\n\nThe first wavelength (index=1) is 550.0.\nThe second wavelength (index=2) is 650.0.\n\nSky Radiance Data Block:\n\nThe line 1 1 0 10.5 corresponds to: Wavelength Index 1, Zenith Index 1, Azimuth Index 0, with a radiance value of 10.5.\nThe line 2 2 1 15.3 corresponds to: Wavelength Index 2, Zenith Index 2, Azimuth Index 1, with a radiance value of 15.3, and so on for all 6 lines."
  },
  {
    "objectID": "input_docs/skydist_inp.html#file-format",
    "href": "input_docs/skydist_inp.html#file-format",
    "title": "Tabulated Sky Radiance Input (skydist.inp)",
    "section": "",
    "text": "The skydist.inp file has a multi-part structure consisting of a header, a list of wavelengths, and a data block of radiance values. The file is read in free-format, meaning all numerical values should be separated by spaces or commas.\n\n\nThe very first line of the file must contain 4 integer values that define the dimensions of the sky data:\n\nnumskyelem: The total number of individual sky radiance data points that will be listed in the data block section of the file.\nsky_zenith: The number of zenith angle bins used in the sky distribution (i.e., the number of divisions from the horizon to the point directly overhead).\nsky_azimuth: The number of azimuthal angle bins. Note that the azimuth index in the data block will range from 0 to this value.\nnumskywave: The number of distinct wavelengths for which sky radiance data is provided.\n\n\n\n\nThe second line of the file must list the actual wavelength values. The number of values on this line must match the numskywave parameter from the header line.\n\n\n\nFollowing the first two lines, the remainder of the file consists of the sky radiance data points. The number of lines in this section must match the numskyelem parameter from the header line.\nEach line in this block represents a single sky “patch” or element and must contain 4 values:\n\nWavelength Index: An integer (1-based) that points to a wavelength in the Wavelengths Line. For example, a value of 1 corresponds to the first wavelength listed.\nZenith Index: An integer (1-based) specifying the zenith angle bin, from 1 to sky_zenith.\nAzimuth Index: An integer (0-based) specifying the azimuth angle bin, from 0 to sky_azimuth.\nRadiance Value: A floating-point number representing the radiance intensity for that specific sky patch.\n\nThis format allows for a sparse representation of the sky; you only need to provide entries for the sky patches that have non-zero radiance.\n\n\n\nAfter reading this file, the AOMC model processes the data for each wavelength by:\n\nSumming all radiance values for that wavelength.\nNormalizing the values so they represent a probability distribution.\nMultiplying this distribution by the total number of iterations (from amc.inp) to determine how many photons should be initiated from each specific sky patch.\n\n\n\n\nIt is not necessary for the wavelengths listed in this file to exactly match the simulation wavebands defined in lambbot.inp. The model does not interpolate the sky data. Instead, for each simulation waveband, the model performs a nearest-neighbor search. It identifies the single, numerically closest wavelength provided in skydist.inp and uses the complete sky radiance distribution from that single entry for the entire simulation run of that waveband.\nFor example, if skydist.inp contains data for 500nm and 600nm, and the simulation is running for wavebands at 520nm, 540nm, and 580nm:\n\nThe 520nm run will use the sky data for 500nm.\nThe 540nm run will also use the sky data for 500nm (since 540 is closer to 500 than to 600).\nThe 580nm run will use the sky data for 600nm.\n\n\n\n\nThe AOMC model expects input files to contain only the required numerical data in the correct order."
  },
  {
    "objectID": "input_docs/skydist_inp.html#example",
    "href": "input_docs/skydist_inp.html#example",
    "title": "Tabulated Sky Radiance Input (skydist.inp)",
    "section": "",
    "text": "Below is a valid skydist.inp file, followed by an explanation of its contents.\nFile Content:\n6 2 2 2\n550.0 650.0\n1 1 0 10.5\n1 1 1 12.0\n1 2 1 20.0\n2 1 0 8.2\n2 1 1 9.5\n2 2 1 15.3\nExplanation of the Example:\n\nHeader Line (6 2 2 2):\n\n6: There are 6 radiance data lines to read in the data block.\n2: The sky is divided into 2 zenith bins (indexed 1 and 2).\n2: The sky is divided into 3 azimuth bins (indexed 0, 1, and 2).\n2: The file provides data for 2 different wavelengths.\n\nWavelengths Line (550.0 650.0):\n\nThe first wavelength (index=1) is 550.0.\nThe second wavelength (index=2) is 650.0.\n\nSky Radiance Data Block:\n\nThe line 1 1 0 10.5 corresponds to: Wavelength Index 1, Zenith Index 1, Azimuth Index 0, with a radiance value of 10.5.\nThe line 2 2 1 15.3 corresponds to: Wavelength Index 2, Zenith Index 2, Azimuth Index 1, with a radiance value of 15.3, and so on for all 6 lines."
  },
  {
    "objectID": "input_docs/amc_inp.html",
    "href": "input_docs/amc_inp.html",
    "title": "AMC Input Parameters (amc.inp)",
    "section": "",
    "text": "AMC Input Parameters (amc.inp)\nThis document describes the input parameters for the AOMC model, as defined in the amc.inp file. The mc.f90 program reads this file, and is very specific about the data format and range of values for each parameter.\nImportant Note for Float Parameters: When providing input for parameters with a “Float” data type, you must include a decimal point, even if the value is a whole number (e.g., 100.0 instead of 100).\nThe following table details each parameter, its data type, valid range, and any additional notes or restrictions.\n\n\n\n\n\n\n\n\n\nInput Parameter\nData Type\nRange of Values\nNote\n\n\n\n\n1) Iterations\nInteger\n[0, 99999999]\nNumber of photons (iterations) to simulate.\n\n\n2) Light source from model(0) or file(1)\nInteger\n[0, 1]\nUse boundary light condition from a lookup table (1) or let the model generate it (0).\n\n\n2a) direct azimuth angle(deg)\nInteger\n[0, 359]\nAzimuth angle of specular light source (if using model’s skylight distribution).\n\n\n2b) direct zenith angle(deg)\nInteger\n[0, 89]\nZenith angle of specular light source. 0 deg is the poleward angle.\n\n\n3) number of system constituents\nInteger\n[1, 20]\nNumber of water constituents (including water). Minimum value is 1.\n\n\n4) depth (M)\nFloat\n]0, 10000[\nDepth of bottom boundary in meters.\n\n\n5) side boundaries (M)\nFloat\n]0, 100000[\nWidth of side boundary (same for both X and Y) in meters.\n\n\n6) Number of depth recording layers\nInteger\n[2, 500]\nNumber of layers in which apparent optical properties are to be recorded.\n\n\n6a) Thickness of each recording layer\nFloat\n[-1] U ]0, +inf[\nThickness of recording layers in meters. If set to -1.0, layers will span the entire water column.\n\n\n7) # of alpha intervals to bin (MAX=180)\nInteger\n[1, 180]\nNumber of equal latitude bins for photon vector angle. Must be an even number.\n\n\n8) # of phi intervals to bin (MAX=180)\nInteger\n[1, 360]\nNumber of equal longitude bins for photon vector angle.\n\n\n8a) Interval type (ang = 1,cos = 0)\nInteger\n[0, 1]\nDefines interval type.\n\n\n9) X,Y,Z for absorption (yes=1,no=0)\nInteger\n[0, 1]\nLog all instances of absorption within the water column. Only for single wavelength mode.\n\n\n10) BOT.-output(yes=1,no=0)\nInteger\n[0, 1]\nLog all instances of photons absorbed by the bottom boundary. Only for single wavelength mode.\n\n\n11) SIDE-output(yes=1,no=0)\nInteger\n[0, 1]\nLog all instances of photons absorbed by the side boundary. Only for single wavelength mode.\n\n\n12) SPF from file? (yes=1,no=0)\nInteger\n[0, 1]\nDetermine if the cumulative SPF is to be read from a file (1) or randomly determined from an isotropic function (0).\n\n\n12a) Number of angles\nInteger\n[0, 360]\nNumber of scattering phase function angles to read in.\n\n\n13) # of concentration dependent layers\nInteger\n[1, 100]\nNumber of layers with different optical characteristics.\n\n\n14) Number of cells in X-Y direction(0=NOGRID)\nInteger\n[0, 101]\nNumber of rows and columns for grid output. If 0, no grid file is created. Must be an odd number.\n\n\n14a) Cell size (in unit meters)\nFloat\n]0, inf[\nSize of each cell (same for dX and dY) in meters.\n\n\n14b) Output to Surfer format (yes=1,no=0)\nInteger\n[0, 1]\nIf 1, output is in Surfer GRID ASCII format.\n\n\n15) Light source: point[1],circle[2],rect.[3]\nInteger\n[1, 2, 3]\nType of light source.\n\n\n15a) If circle, define diameter\nFloat\n]0, +inf[\nDiameter of the collimated light source if circular.\n\n\n15b) If rectangle, define dX\nFloat\n]0, +inf[\nX dimension if rectangular light source.\n\n\n15c) and define dY\nFloat\n]0, +inf[\nY dimension if rectangular light source.\n\n\n16) Bottom target: NO[0],YES[1]\nInteger\n[0, 1]\nSpecify a bottom target.\n\n\n16a) define dX\nFloat\n]0, +inf[\nX dimension of the target.\n\n\n16b) define dY\nFloat\n]0, +inf[\nY dimension of the target.\n\n\n17) Normalize output to air(0) or water(1)\nInteger\n[0, 1]\nNormalize optical properties to incident radiation on water surface (0) or just below (1).\n\n\n18) Number of wavebands (minimum = 1)\nInteger\n[1, 500]\nNumber of wavebands to simulate."
  }
]