[
  {
    "objectID": "input_docs/difcol_inp.html",
    "href": "input_docs/difcol_inp.html",
    "title": "Direct vs. Diffuse Light Input Parameters (difcol.inp)",
    "section": "",
    "text": "This document describes the format for the difcol.inp file. This file provides wavelength-dependent data on the fraction of collimated (direct) light and the relative intensity of photons for each waveband.\nImportant: This file is only read by the model if parameter 2) Light source from model(0) or file(1) in amc.inp is set to 0.\n\n\nThe structure of the difcol.inp file is as follows:\n\nNumber of Wavebands: The very first value in the file must be an integer representing the total number of wavebands. This number must match the value specified for parameter 18) Number of wavebands in the amc.inp file.\nLight Fraction and Intensity: Following the number of wavebands, the file must contain one line of data for each waveband. Each line consists of two floating-point values:\n\nDirect Fraction: The first value on the line is the fraction of light that is collimated (direct) for that specific waveband. This should be a value between 0.0 and 1.0.\nRelative Intensity: The second value is a weighting factor for the number of photons to be simulated at that waveband. This factor is multiplied by the total number of iterations (parameter 1) Iterations in amc.inp) to determine the actual number of photons simulated for the waveband.\n\nData Format: The numerical values are read in free-format (list-directed). This means the numbers should be separated by spaces or commas and do not need to be aligned in fixed columns.\n\n\n\n\nHere is a sample difcol.inp file configured for 12 wavebands.\n12\n0.8 1.0\n0.8 1.0\n0.7 1.0\n0.7 0.9\n0.6 0.9\n0.6 0.8\n0.5 0.8\n0.5 0.7\n0.4 0.7\n0.4 0.6\n0.3 0.5\n0.3 0.4\n\n--- NOTES ---\nThis section is not read by the AOMC model.\nEach line of data represents a waveband.\nFor each waveband, the values are:\n[Direct Fraction] [Relative Intensity]"
  },
  {
    "objectID": "input_docs/difcol_inp.html#file-format",
    "href": "input_docs/difcol_inp.html#file-format",
    "title": "Direct vs. Diffuse Light Input Parameters (difcol.inp)",
    "section": "",
    "text": "The structure of the difcol.inp file is as follows:\n\nNumber of Wavebands: The very first value in the file must be an integer representing the total number of wavebands. This number must match the value specified for parameter 18) Number of wavebands in the amc.inp file.\nLight Fraction and Intensity: Following the number of wavebands, the file must contain one line of data for each waveband. Each line consists of two floating-point values:\n\nDirect Fraction: The first value on the line is the fraction of light that is collimated (direct) for that specific waveband. This should be a value between 0.0 and 1.0.\nRelative Intensity: The second value is a weighting factor for the number of photons to be simulated at that waveband. This factor is multiplied by the total number of iterations (parameter 1) Iterations in amc.inp) to determine the actual number of photons simulated for the waveband.\n\nData Format: The numerical values are read in free-format (list-directed). This means the numbers should be separated by spaces or commas and do not need to be aligned in fixed columns."
  },
  {
    "objectID": "input_docs/difcol_inp.html#example",
    "href": "input_docs/difcol_inp.html#example",
    "title": "Direct vs. Diffuse Light Input Parameters (difcol.inp)",
    "section": "",
    "text": "Here is a sample difcol.inp file configured for 12 wavebands.\n12\n0.8 1.0\n0.8 1.0\n0.7 1.0\n0.7 0.9\n0.6 0.9\n0.6 0.8\n0.5 0.8\n0.5 0.7\n0.4 0.7\n0.4 0.6\n0.3 0.5\n0.3 0.4\n\n--- NOTES ---\nThis section is not read by the AOMC model.\nEach line of data represents a waveband.\nFor each waveband, the values are:\n[Direct Fraction] [Relative Intensity]"
  },
  {
    "objectID": "input_docs/amc_inp.html",
    "href": "input_docs/amc_inp.html",
    "title": "AMC Input Parameters (amc.inp)",
    "section": "",
    "text": "AMC Input Parameters (amc.inp)\nThis document describes the input parameters for the AOMC model, as defined in the amc.inp file. The mc.f90 program reads this file, and is very specific about the data format and range of values for each parameter.\nImportant Note for Float Parameters: When providing input for parameters with a “Float” data type, you must include a decimal point, even if the value is a whole number (e.g., 100.0 instead of 100).\nThe following table details each parameter, its data type, valid range, and any additional notes or restrictions.\n\n\n\n\n\n\n\n\n\nInput Parameter\nData Type\nRange of Values\nNote\n\n\n\n\n1) Iterations\nInteger\n[0, 99999999]\nNumber of photons (iterations) to simulate.\n\n\n2) Light source from model(0) or file(1)\nInteger\n[0, 1]\nUse boundary light condition from a lookup table (1) or let the model generate it (0).\n\n\n2a) direct azimuth angle(deg)\nInteger\n[0, 359]\nAzimuth angle of specular light source (if using model’s skylight distribution).\n\n\n2b) direct zenith angle(deg)\nInteger\n[0, 89]\nZenith angle of specular light source. 0 deg is the poleward angle.\n\n\n3) number of system constituents\nInteger\n[1, 20]\nNumber of water constituents (including water). Minimum value is 1.\n\n\n4) depth (M)\nFloat\n]0, 10000[\nDepth of bottom boundary in meters.\n\n\n5) side boundaries (M)\nFloat\n]0, 100000[\nWidth of side boundary (same for both X and Y) in meters.\n\n\n6) Number of depth recording layers\nInteger\n[2, 500]\nNumber of layers in which apparent optical properties are to be recorded.\n\n\n6a) Thickness of each recording layer\nFloat\n[-1] U ]0, +inf[\nThickness of recording layers in meters. If set to -1.0, layers will span the entire water column.\n\n\n7) # of alpha intervals to bin (MAX=180)\nInteger\n[1, 180]\nNumber of equal latitude bins for photon vector angle. Must be an even number.\n\n\n8) # of phi intervals to bin (MAX=180)\nInteger\n[1, 360]\nNumber of equal longitude bins for photon vector angle.\n\n\n8a) Use polar cap as grid?(yes=1, no=0)\nInteger\n[0, 1]\nA value of 1 will create a single polar bin. A value of 0 will break down the polar cap into PHI number of bins.\n\n\n8b) Interval type (ang = 1,cos = 0)\nInteger\n[0, 1]\nDefines interval type.\n\n\n9) X,Y,Z for absorption (yes=1,no=0)\nInteger\n[0, 1]\nLog all instances of absorption within the water column. Only for single wavelength mode.\n\n\n10) BOT.-output(yes=1,no=0)\nInteger\n[0, 1]\nLog all instances of photons absorbed by the bottom boundary. Only for single wavelength mode.\n\n\n11) SIDE-output(yes=1,no=0)\nInteger\n[0, 1]\nLog all instances of photons absorbed by the side boundary. Only for single wavelength mode.\n\n\n12) SPF from file? (yes=1,no=0)\nInteger\n[0, 1]\nDetermine if the cumulative SPF is to be read from a file (1) or randomly determined from an isotropic function (0).\n\n\n12a) Number of angles\nInteger\n[0, 360]\nNumber of scattering phase function angles to read in.\n\n\n13) # of concentration dependent layers\nInteger\n[1, 100]\nNumber of layers with different optical characteristics.\n\n\n14) Number of cells in X-Y direction(0=NOGRID)\nInteger\n[0, 101]\nNumber of rows and columns for grid output. If 0, no grid file is created. Must be an odd number.\n\n\n14a) Cell size (in unit meters)\nFloat\n]0, inf[\nSize of each cell (same for dX and dY) in meters.\n\n\n14b) Output to Surfer format (yes=1,no=0)\nInteger\n[0, 1]\nIf 1, output is in Surfer GRID ASCII format.\n\n\n15) Light source: point[1],circle[2],rect.[3]\nInteger\n[1, 2, 3]\nType of light source.\n\n\n15a) If circle, define diameter\nFloat\n]0, +inf[\nDiameter of the collimated light source if circular.\n\n\n15b) If rectangle, define dX\nFloat\n]0, +inf[\nX dimension if rectangular light source.\n\n\n15c) and define dY\nFloat\n]0, +inf[\nY dimension if rectangular light source.\n\n\n16) Bottom target: NO[0],YES[1]\nInteger\n[0, 1]\nSpecify a bottom target.\n\n\n16a) define dX\nFloat\n]0, +inf[\nX dimension of the target.\n\n\n16b) define dY\nFloat\n]0, +inf[\nY dimension of the target.\n\n\n17) Normalize output to air(0) or water(1)\nInteger\n[0, 1]\nNormalize optical properties to incident radiation on water surface (0) or just below (1).\n\n\n18) Number of wavebands (minimum = 1)\nInteger\n[1, 500]\nNumber of wavebands to simulate."
  },
  {
    "objectID": "input_docs/abs_inp.html",
    "href": "input_docs/abs_inp.html",
    "title": "Specific Absorption Coefficient Input Parameters (abs.inp)",
    "section": "",
    "text": "This document describes the format for the abs.inp file, which defines the wavelength-dependent specific absorption coefficients for the various water quality constituents simulated by the AOMC model. For consistent calculation of bulk optical properties, the specific absorption coefficients must be provided in units of \\(m^2/per\\ unit\\ of\\ weight\\) (e.g., \\(m^2/mg\\)). Therefore, it is crucial that the corresponding constituent concentrations in the conc.inp file are consistently recorded as the same weight per unit volume (e.g., \\(mg/m^3\\)).\n\n\nThe structure of the abs.inp file is strict and must conform to the following rules for the model to parse it correctly:\n\nNumber of Wavebands: The very first value in the file must be an integer representing the total number of wavebands. This number must match the value specified for parameter 18) Number of wavebands in the amc.inp file.\nAbsorption Coefficients: Following the number of wavebands, the file must contain a matrix of absorption coefficient values.\n\nRows: The number of rows in this matrix must match the number of wavebands declared on the first line.\nColumns: The number of columns must match the number of system constituents specified in parameter 3) number of system constituents in the amc.inp file. Each column represents a constituent (e.g., pure water, phytoplankton, non-algal particles, DOM).\nData Format: The numerical values are read in free-format (list-directed). This means the numbers should be separated by spaces or commas. They do not need to be aligned in fixed columns, as long as each line contains the correct number of values.\n\nAdditional Information: Any text or data placed after the absorption coefficient matrix is ignored by the model. This space can be used for comments, notes, or metadata, as shown in the example below.\n\n\n\n\nHere is a sample abs.inp file configured for 12 wavebands and 3 system constituents.\n12\n0.0049  0.032  0.004\n0.0051  0.033  0.004\n0.0058  0.035  0.004\n0.0125  0.040  0.004\n0.0210  0.046  0.004\n0.0380  0.052  0.004\n0.0510  0.058  0.004\n0.0620  0.061  0.004\n0.0810  0.063  0.004\n0.1090  0.062  0.004\n0.1550  0.059  0.004\n0.2220  0.051  0.004\n\n--- NOTES ---\nThis section is not read by the AOMC model.\nThe columns represent the following constituents:\n1. Pure Water\n2. Phytoplankton\n3. Non-Algal Particles\nData sourced from internal lab measurements, 2023."
  },
  {
    "objectID": "input_docs/abs_inp.html#file-format",
    "href": "input_docs/abs_inp.html#file-format",
    "title": "Specific Absorption Coefficient Input Parameters (abs.inp)",
    "section": "",
    "text": "The structure of the abs.inp file is strict and must conform to the following rules for the model to parse it correctly:\n\nNumber of Wavebands: The very first value in the file must be an integer representing the total number of wavebands. This number must match the value specified for parameter 18) Number of wavebands in the amc.inp file.\nAbsorption Coefficients: Following the number of wavebands, the file must contain a matrix of absorption coefficient values.\n\nRows: The number of rows in this matrix must match the number of wavebands declared on the first line.\nColumns: The number of columns must match the number of system constituents specified in parameter 3) number of system constituents in the amc.inp file. Each column represents a constituent (e.g., pure water, phytoplankton, non-algal particles, DOM).\nData Format: The numerical values are read in free-format (list-directed). This means the numbers should be separated by spaces or commas. They do not need to be aligned in fixed columns, as long as each line contains the correct number of values.\n\nAdditional Information: Any text or data placed after the absorption coefficient matrix is ignored by the model. This space can be used for comments, notes, or metadata, as shown in the example below."
  },
  {
    "objectID": "input_docs/abs_inp.html#example",
    "href": "input_docs/abs_inp.html#example",
    "title": "Specific Absorption Coefficient Input Parameters (abs.inp)",
    "section": "",
    "text": "Here is a sample abs.inp file configured for 12 wavebands and 3 system constituents.\n12\n0.0049  0.032  0.004\n0.0051  0.033  0.004\n0.0058  0.035  0.004\n0.0125  0.040  0.004\n0.0210  0.046  0.004\n0.0380  0.052  0.004\n0.0510  0.058  0.004\n0.0620  0.061  0.004\n0.0810  0.063  0.004\n0.1090  0.062  0.004\n0.1550  0.059  0.004\n0.2220  0.051  0.004\n\n--- NOTES ---\nThis section is not read by the AOMC model.\nThe columns represent the following constituents:\n1. Pure Water\n2. Phytoplankton\n3. Non-Algal Particles\nData sourced from internal lab measurements, 2023."
  },
  {
    "objectID": "input_docs/compilation.html",
    "href": "input_docs/compilation.html",
    "title": "Compiling the AOMC Fortran Code",
    "section": "",
    "text": "This document provides instructions on how to compile the Fortran source code for the AOMC project using the gfortran compiler. All source code is located in the src/ directory.\nThe compilation should be run from the root directory of the project.\n\n\nA build.sh script is provided to automate the entire compilation process. To compile the model, simply run the script from the project’s root directory:\n./build.sh\nThis will compile the necessary files in order, create the aomc executable in the root directory, and clean up the intermediate object (.o) and module (.mod) files.\n\n\n\nIf you prefer to compile the files manually, follow these steps from the root directory.\n\n\nFirst, compile the files that define the modules. This will create global.o, modules.o, and the corresponding .mod files in your root directory.\ngfortran -c src/global.f90 src/modules.f90\n\n\n\nNext, compile the rest of the source files. The compiler will use the .mod files created in the previous step.\ngfortran -c src/geom2.f90 src/interface.f90 src/light_internal.f90 src/logbin.f90 src/mc.f90 src/vsf.f90 src/water.f90\n\n\n\nFinally, link all the generated object files (.o) together to create the executable named aomc in the root directory.\ngfortran -o aomc *.o\n\n\n\nYou can remove the intermediate files.\nrm *.o *.mod\n\n\n\n\nFor reference, this is the content of the build.sh script:\n#!/bin/bash\n# A script to compile the AOMC Fortran project.\n\n# Exit immediately if a command exits with a non-zero status.\nset -e\n\n# Compiler\nFC=gfortran\n\n# List of source files, now in the src/ directory\nMODULE_FILES=\"src/global.f90 src/modules.f90\"\nSOURCE_FILES=\"src/geom2.f90 src/interface.f90 src/light_internal.f90 src/logbin.f90 src/mc.f90 src/vsf.f90 src/water.f90\"\nALL_OBJECTS=\"\"\n\necho \"Compiling modules...\"\n$FC -c $MODULE_FILES\nALL_OBJECTS+=$(basename --multiple $MODULE_FILES | sed 's/\\.f90/\\.o/g')\n\necho \"Compiling other sources...\"\n$FC -c $SOURCE_FILES\nALL_OBJECTS+=\" \"$(basename --multiple $SOURCE_FILES | sed 's/\\.f90/\\.o/g')\n\necho \"Linking...\"\n$FC -o aomc $ALL_OBJECTS\n\necho \"Cleaning up intermediate files...\"\nrm *.o *.mod\n\necho \"Build complete! Executable 'aomc' is ready in the root directory.\""
  },
  {
    "objectID": "input_docs/compilation.html#automated-build-script-recommended",
    "href": "input_docs/compilation.html#automated-build-script-recommended",
    "title": "Compiling the AOMC Fortran Code",
    "section": "",
    "text": "A build.sh script is provided to automate the entire compilation process. To compile the model, simply run the script from the project’s root directory:\n./build.sh\nThis will compile the necessary files in order, create the aomc executable in the root directory, and clean up the intermediate object (.o) and module (.mod) files."
  },
  {
    "objectID": "input_docs/compilation.html#manual-compilation",
    "href": "input_docs/compilation.html#manual-compilation",
    "title": "Compiling the AOMC Fortran Code",
    "section": "",
    "text": "If you prefer to compile the files manually, follow these steps from the root directory.\n\n\nFirst, compile the files that define the modules. This will create global.o, modules.o, and the corresponding .mod files in your root directory.\ngfortran -c src/global.f90 src/modules.f90\n\n\n\nNext, compile the rest of the source files. The compiler will use the .mod files created in the previous step.\ngfortran -c src/geom2.f90 src/interface.f90 src/light_internal.f90 src/logbin.f90 src/mc.f90 src/vsf.f90 src/water.f90\n\n\n\nFinally, link all the generated object files (.o) together to create the executable named aomc in the root directory.\ngfortran -o aomc *.o\n\n\n\nYou can remove the intermediate files.\nrm *.o *.mod"
  },
  {
    "objectID": "input_docs/compilation.html#build.sh-script-content",
    "href": "input_docs/compilation.html#build.sh-script-content",
    "title": "Compiling the AOMC Fortran Code",
    "section": "",
    "text": "For reference, this is the content of the build.sh script:\n#!/bin/bash\n# A script to compile the AOMC Fortran project.\n\n# Exit immediately if a command exits with a non-zero status.\nset -e\n\n# Compiler\nFC=gfortran\n\n# List of source files, now in the src/ directory\nMODULE_FILES=\"src/global.f90 src/modules.f90\"\nSOURCE_FILES=\"src/geom2.f90 src/interface.f90 src/light_internal.f90 src/logbin.f90 src/mc.f90 src/vsf.f90 src/water.f90\"\nALL_OBJECTS=\"\"\n\necho \"Compiling modules...\"\n$FC -c $MODULE_FILES\nALL_OBJECTS+=$(basename --multiple $MODULE_FILES | sed 's/\\.f90/\\.o/g')\n\necho \"Compiling other sources...\"\n$FC -c $SOURCE_FILES\nALL_OBJECTS+=\" \"$(basename --multiple $SOURCE_FILES | sed 's/\\.f90/\\.o/g')\n\necho \"Linking...\"\n$FC -o aomc $ALL_OBJECTS\n\necho \"Cleaning up intermediate files...\"\nrm *.o *.mod\n\necho \"Build complete! Executable 'aomc' is ready in the root directory.\""
  },
  {
    "objectID": "input_docs/theory.html",
    "href": "input_docs/theory.html",
    "title": "AOMC: Radiative Transfer Theory and Model Implementation",
    "section": "",
    "text": "This document provides a summary of the theoretical basis for the AOMC model.\n\n\nThe propagation of light through an aquatic medium is governed by the Radiative Transfer Equation (RTE). The RTE accounts for the various ways light can be absorbed and scattered as it interacts with water and its dissolved and particulate constituents. The key to solving the RTE lies in characterizing the Inherent Optical Properties (IOPs) of the medium. IOPs are properties that depend only on the substances in the medium, not on the ambient light field.\n\n\nThe primary IOPs that determine the fate of light are:\n\n\n\nAbsorption Coefficient (\\(a\\)): The fraction of radiant energy absorbed by the medium per unit path length (units: m⁻¹).\nScattering Coefficient (\\(b\\)): The fraction of radiant energy scattered by the medium per unit path length (units: m⁻¹).\n\nThese two properties combine to form the beam attenuation coefficient (\\(c\\)), which represents the total loss of energy from a light beam due to both absorption and scattering: \\[\nc(\\lambda) = a(\\lambda) + b(\\lambda)\n\\]\nThe single-scattering albedo (\\(\\omega_0\\)) describes the probability that a photon will be scattered rather than absorbed upon interaction: \\[\n\\omega_0(\\lambda) = \\frac{b(\\lambda)}{c(\\lambda)}\n\\]\n\n\n\nFor a medium containing multiple constituents (e.g., pure water, phytoplankton, sediments), the bulk IOPs are the sum of the contributions from each constituent. The contribution of each constituent is its concentration (\\(C_i\\)) multiplied by its specific absorption or scattering coefficient (\\(a_i^*\\) or \\(b_i^*\\)).\nThe bulk absorption coefficient is given by: \\[ a(\\lambda) = a_w(\\lambda) + \\sum_{i=1}^{N} a_i^*(\\lambda)C_i \\] The bulk scattering coefficient is given by: \\[ b(\\lambda) = b_w(\\lambda) + \\sum_{i=1}^{N} b_i^*(\\lambda)C_i \\] where the subscript \\(w\\) refers to pure water and \\(i\\) refers to the i-th constituent.\n\n\n\nWhile the scattering coefficient \\(b\\) describes the total amount of scattering, the Volume Scattering Function (VSF), \\(\\beta(\\psi, \\lambda)\\), describes the angular distribution of the scattered light. It is defined as the radiant intensity scattered from a small volume element in a given direction \\(\\psi\\) per unit of incident irradiance (units: m⁻¹ sr⁻¹).\nThe scattering coefficient \\(b\\) is the integral of the VSF over all solid angles: \\[ b(\\lambda) = 2\\pi \\int_{0}^{\\pi} \\beta(\\psi, \\lambda) \\sin(\\psi) d\\psi \\] A normalized version of the VSF, known as the scattering phase function (\\(\\tilde{\\beta}\\)), gives the probability distribution of a scattering event at a given angle: \\[ \\tilde{\\beta}(\\psi, \\lambda) = \\frac{\\beta(\\psi, \\lambda)}{b(\\lambda)} \\]\n\n\n\n\n\nThe AOMC model uses the Monte Carlo method to solve the RTE. This statistical approach simulates the individual life histories of a large number of photons. By tracking the fate of each photon, the model reconstructs the macroscopic light field (e.g., radiance and irradiance) throughout the water body.\nThe life cycle of a single photon is simulated as follows:\n\n\n\nA photon is generated above the air-water interface. Its initial direction is determined by the sky radiance distribution, which can be either a simple model with direct and diffuse components (difcol.inp) or a tabulated distribution from a file (skydist.inp).\n\n\n\n\n\nWhen the photon strikes the surface, Fresnel’s equations are used with a random number to determine if it is reflected or transmitted into the water.\nIf the photon is transmitted, Snell’s Law is used to calculate its new, refracted angle of travel within the water.\n\n\n\n\n\nThe distance the photon travels between interactions is its optical path length. This step size, \\(\\Delta l\\), is determined probabilistically using the beam attenuation coefficient \\(c(\\lambda)\\) and a random number, \\(\\xi_1\\), uniformly distributed between 0 and 1: \\[ \\Delta l = -\\frac{\\ln(\\xi_1)}{c(\\lambda)} \\]\n\n\n\n\n\nAfter traveling the distance \\(\\Delta l\\), the photon interacts with the medium. A decision is made to either absorb or scatter the photon.\nA new random number, \\(\\xi_2\\), is generated and compared to the single-scattering albedo, \\(\\omega_0(\\lambda)\\).\n\nIf \\(\\xi_2 \\le \\omega_0(\\lambda)\\), the photon is scattered.\nIf \\(\\xi_2 &gt; \\omega_0(\\lambda)\\), the photon is absorbed, and its simulation is terminated.\n\n\n\n\n\n\nIf the photon is scattered, its direction must change.\n\nSelect Constituent: The model first determines which constituent particle scattered the photon. This is a random choice weighted by the relative scattering contribution of each constituent at that wavelength.\nSelect New Angle: The model then uses the cumulative scattering phase function for that specific particle (from spf.inp) as a probability table. A new random number, \\(\\xi_3\\), is generated to select a new polar scattering angle, \\(\\theta\\). A uniformly distributed random number determines the azimuthal scattering angle, \\(\\phi\\).\n\n\n\n\n\nThe photon’s life ends when one of the following occurs:\n\nIt is absorbed within the water column.\nIt scatters upward and passes back out through the air-water interface.\nIt hits a side boundary of the model domain.\nIt strikes the bottom boundary. At the bottom, a random number is compared to the bottom reflectance (\\(R_b\\)) from lambbot.inp.\n\nIf absorbed, the photon is terminated.\nIf reflected, another random number determines if the reflection is specular (mirror-like) or diffuse (Lambertian), and the photon’s journey continues in an upward direction."
  },
  {
    "objectID": "input_docs/theory.html#theory-of-radiative-transfer",
    "href": "input_docs/theory.html#theory-of-radiative-transfer",
    "title": "AOMC: Radiative Transfer Theory and Model Implementation",
    "section": "",
    "text": "The propagation of light through an aquatic medium is governed by the Radiative Transfer Equation (RTE). The RTE accounts for the various ways light can be absorbed and scattered as it interacts with water and its dissolved and particulate constituents. The key to solving the RTE lies in characterizing the Inherent Optical Properties (IOPs) of the medium. IOPs are properties that depend only on the substances in the medium, not on the ambient light field.\n\n\nThe primary IOPs that determine the fate of light are:\n\n\n\nAbsorption Coefficient (\\(a\\)): The fraction of radiant energy absorbed by the medium per unit path length (units: m⁻¹).\nScattering Coefficient (\\(b\\)): The fraction of radiant energy scattered by the medium per unit path length (units: m⁻¹).\n\nThese two properties combine to form the beam attenuation coefficient (\\(c\\)), which represents the total loss of energy from a light beam due to both absorption and scattering: \\[\nc(\\lambda) = a(\\lambda) + b(\\lambda)\n\\]\nThe single-scattering albedo (\\(\\omega_0\\)) describes the probability that a photon will be scattered rather than absorbed upon interaction: \\[\n\\omega_0(\\lambda) = \\frac{b(\\lambda)}{c(\\lambda)}\n\\]\n\n\n\nFor a medium containing multiple constituents (e.g., pure water, phytoplankton, sediments), the bulk IOPs are the sum of the contributions from each constituent. The contribution of each constituent is its concentration (\\(C_i\\)) multiplied by its specific absorption or scattering coefficient (\\(a_i^*\\) or \\(b_i^*\\)).\nThe bulk absorption coefficient is given by: \\[ a(\\lambda) = a_w(\\lambda) + \\sum_{i=1}^{N} a_i^*(\\lambda)C_i \\] The bulk scattering coefficient is given by: \\[ b(\\lambda) = b_w(\\lambda) + \\sum_{i=1}^{N} b_i^*(\\lambda)C_i \\] where the subscript \\(w\\) refers to pure water and \\(i\\) refers to the i-th constituent.\n\n\n\nWhile the scattering coefficient \\(b\\) describes the total amount of scattering, the Volume Scattering Function (VSF), \\(\\beta(\\psi, \\lambda)\\), describes the angular distribution of the scattered light. It is defined as the radiant intensity scattered from a small volume element in a given direction \\(\\psi\\) per unit of incident irradiance (units: m⁻¹ sr⁻¹).\nThe scattering coefficient \\(b\\) is the integral of the VSF over all solid angles: \\[ b(\\lambda) = 2\\pi \\int_{0}^{\\pi} \\beta(\\psi, \\lambda) \\sin(\\psi) d\\psi \\] A normalized version of the VSF, known as the scattering phase function (\\(\\tilde{\\beta}\\)), gives the probability distribution of a scattering event at a given angle: \\[ \\tilde{\\beta}(\\psi, \\lambda) = \\frac{\\beta(\\psi, \\lambda)}{b(\\lambda)} \\]"
  },
  {
    "objectID": "input_docs/theory.html#the-aomc-model-implementation",
    "href": "input_docs/theory.html#the-aomc-model-implementation",
    "title": "AOMC: Radiative Transfer Theory and Model Implementation",
    "section": "",
    "text": "The AOMC model uses the Monte Carlo method to solve the RTE. This statistical approach simulates the individual life histories of a large number of photons. By tracking the fate of each photon, the model reconstructs the macroscopic light field (e.g., radiance and irradiance) throughout the water body.\nThe life cycle of a single photon is simulated as follows:\n\n\n\nA photon is generated above the air-water interface. Its initial direction is determined by the sky radiance distribution, which can be either a simple model with direct and diffuse components (difcol.inp) or a tabulated distribution from a file (skydist.inp).\n\n\n\n\n\nWhen the photon strikes the surface, Fresnel’s equations are used with a random number to determine if it is reflected or transmitted into the water.\nIf the photon is transmitted, Snell’s Law is used to calculate its new, refracted angle of travel within the water.\n\n\n\n\n\nThe distance the photon travels between interactions is its optical path length. This step size, \\(\\Delta l\\), is determined probabilistically using the beam attenuation coefficient \\(c(\\lambda)\\) and a random number, \\(\\xi_1\\), uniformly distributed between 0 and 1: \\[ \\Delta l = -\\frac{\\ln(\\xi_1)}{c(\\lambda)} \\]\n\n\n\n\n\nAfter traveling the distance \\(\\Delta l\\), the photon interacts with the medium. A decision is made to either absorb or scatter the photon.\nA new random number, \\(\\xi_2\\), is generated and compared to the single-scattering albedo, \\(\\omega_0(\\lambda)\\).\n\nIf \\(\\xi_2 \\le \\omega_0(\\lambda)\\), the photon is scattered.\nIf \\(\\xi_2 &gt; \\omega_0(\\lambda)\\), the photon is absorbed, and its simulation is terminated.\n\n\n\n\n\n\nIf the photon is scattered, its direction must change.\n\nSelect Constituent: The model first determines which constituent particle scattered the photon. This is a random choice weighted by the relative scattering contribution of each constituent at that wavelength.\nSelect New Angle: The model then uses the cumulative scattering phase function for that specific particle (from spf.inp) as a probability table. A new random number, \\(\\xi_3\\), is generated to select a new polar scattering angle, \\(\\theta\\). A uniformly distributed random number determines the azimuthal scattering angle, \\(\\phi\\).\n\n\n\n\n\nThe photon’s life ends when one of the following occurs:\n\nIt is absorbed within the water column.\nIt scatters upward and passes back out through the air-water interface.\nIt hits a side boundary of the model domain.\nIt strikes the bottom boundary. At the bottom, a random number is compared to the bottom reflectance (\\(R_b\\)) from lambbot.inp.\n\nIf absorbed, the photon is terminated.\nIf reflected, another random number determines if the reflection is specular (mirror-like) or diffuse (Lambertian), and the photon’s journey continues in an upward direction."
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About the AOMC Project",
    "section": "",
    "text": "The Aquatic Optics Monte Carlo (AOMC) model is an open-source tool designed to simulate the propagation of light in an optically shallow, vertically heterogeneous aquatic medium. It was originally developed in 2003 using strict FORTRAN 90 standards to ensure broad compatibility across different computing platforms.\nThe primary motivation behind AOMC was to provide researchers and students with a flexible and transparent tool for exploring radiative transfer theory in aquatic environments. While the model has not been in active development since 2003, its core physics and Monte Carlo engine remain a valuable resource for educational and research purposes."
  },
  {
    "objectID": "about.html#about-the-model",
    "href": "about.html#about-the-model",
    "title": "About the AOMC Project",
    "section": "",
    "text": "The Aquatic Optics Monte Carlo (AOMC) model is an open-source tool designed to simulate the propagation of light in an optically shallow, vertically heterogeneous aquatic medium. It was originally developed in 2003 using strict FORTRAN 90 standards to ensure broad compatibility across different computing platforms.\nThe primary motivation behind AOMC was to provide researchers and students with a flexible and transparent tool for exploring radiative transfer theory in aquatic environments. While the model has not been in active development since 2003, its core physics and Monte Carlo engine remain a valuable resource for educational and research purposes."
  },
  {
    "objectID": "about.html#author",
    "href": "about.html#author",
    "title": "About the AOMC Project",
    "section": "Author",
    "text": "Author\nThe AOMC model was created and is maintained by Manuel Gimond.\n\nGitHub Profile: github.com/mgimond"
  },
  {
    "objectID": "about.html#how-to-cite",
    "href": "about.html#how-to-cite",
    "title": "About the AOMC Project",
    "section": "How to Cite",
    "text": "How to Cite\nIf you use this model or its source code in your research, please cite the following publication:\n\nGimond M., 2004. Description and verification of an aquatic optics Monte Carlo model. Environmental Modelling and Software, vol 19, n. 12, pp 1065-1076."
  },
  {
    "objectID": "about.html#license",
    "href": "about.html#license",
    "title": "About the AOMC Project",
    "section": "License",
    "text": "License\nThe AOMC source code is open source and available under the MIT License. You can view the full license file here."
  },
  {
    "objectID": "about.html#contact-and-support",
    "href": "about.html#contact-and-support",
    "title": "About the AOMC Project",
    "section": "Contact and Support",
    "text": "Contact and Support\nPlease note that this project is not actively maintained. Support is very limited.\nFor bug reports, questions, or suggestions, the preferred method is to open an issue on the AOMC GitHub repository’s issue tracker."
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "AOMC Model Documentation",
    "section": "",
    "text": "AOMC Illustration (Created by N.A.G.)"
  },
  {
    "objectID": "index.html#what-is-the-aomc-model",
    "href": "index.html#what-is-the-aomc-model",
    "title": "AOMC Model Documentation",
    "section": "What is the AOMC model?",
    "text": "What is the AOMC model?\nThe Aquatic Optics Monte Carlo (AOMC) model is an open-source tool designed to simulate the propagation of light in an optically shallow, vertically heterogeneous aquatic medium. It was originally developed in 2003 using strict FORTRAN 90 standards to ensure broad compatibility across different computing platforms.\nFor more on the project’s history, author, and citation guidelines, please see the About page.\n\nAOMC GitHub Repository"
  },
  {
    "objectID": "index.html#what-will-the-model-simulate",
    "href": "index.html#what-will-the-model-simulate",
    "title": "AOMC Model Documentation",
    "section": "What will the model simulate?",
    "text": "What will the model simulate?\nThe model simulates radiometric quantities (as measured by radiometers) such as:\n\nUpwelling and downwelling scalar and planar irradiances (Euo, Edo, Eu and Ed)\nRadiance\nMean cosines\nShape factors (as used in the two-flow or two-stream model)\nSurface Albedo\n\nA detailed description of the underlying radiative transfer theory can be found in the Model Theory document."
  },
  {
    "objectID": "index.html#how-do-i-compile-the-code",
    "href": "index.html#how-do-i-compile-the-code",
    "title": "AOMC Model Documentation",
    "section": "How do I compile the code?",
    "text": "How do I compile the code?\nCompilation instructions can be found on the Compilation page."
  },
  {
    "objectID": "index.html#input-file-documentation",
    "href": "index.html#input-file-documentation",
    "title": "AOMC Model Documentation",
    "section": "Input File Documentation",
    "text": "Input File Documentation\nThe AOMC model is configured through a series of plain text input files. Detailed documentation for the format of each file can be found below:\n\namc.inp: Main model configuration.\nabs.inp: Specific absorption coefficients.\nscat.inp: Specific scattering coefficients.\nconc.inp: Constituent concentrations by layer.\nspf.inp: Scattering phase function definitions.\nlambbot.inp: Wavelength and bottom reflectance properties.\ndifcol.inp: Direct vs. diffuse light fractions (used when lsource=0).\nskydist.inp: Tabulated sky radiance data (used when lsource=1)."
  },
  {
    "objectID": "input_docs/skydist_inp.html",
    "href": "input_docs/skydist_inp.html",
    "title": "Tabulated Sky Radiance Input (skydist.inp)",
    "section": "",
    "text": "This document describes the format for the skydist.inp file, which allows the user to provide a custom, tabulated sky radiance distribution for the model’s light source.\nImportant: This file is only read by the model if parameter 2) Light source from model(0) or file(1) in amc.inp is set to 1.\n\n\nThe skydist.inp file has a multi-part structure consisting of a header, a list of wavelengths, and a data block of radiance values. The file is read in free-format, meaning all numerical values should be separated by spaces or commas.\n\n\nThe very first line of the file must contain 4 integer values that define the dimensions of the sky data:\n\nnumskyelem: The total number of individual sky radiance data points that will be listed in the data block section of the file.\nsky_zenith: The number of zenith angle bins used in the sky distribution (i.e., the number of divisions from the horizon to the point directly overhead).\nsky_azimuth: The number of azimuthal angle bins. Note that the azimuth index in the data block will range from 0 to this value.\nnumskywave: The number of distinct wavelengths for which sky radiance data is provided.\n\n\n\n\nThe second line of the file must list the actual wavelength values. The number of values on this line must match the numskywave parameter from the header line.\n\n\n\nFollowing the first two lines, the remainder of the file consists of the sky radiance data points. The number of lines in this section must match the numskyelem parameter from the header line.\nEach line in this block represents a single sky “patch” or element and must contain 4 values:\n\nWavelength Index: An integer (1-based) that points to a wavelength in the Wavelengths Line. For example, a value of 1 corresponds to the first wavelength listed.\nZenith Index: An integer (1-based) specifying the zenith angle bin, from 1 to sky_zenith.\nAzimuth Index: An integer (0-based) specifying the azimuth angle bin, from 0 to sky_azimuth.\nRadiance Value: A floating-point number representing the radiance intensity for that specific sky patch.\n\nThis format allows for a sparse representation of the sky; you only need to provide entries for the sky patches that have non-zero radiance.\n\n\n\nAfter reading this file, the AOMC model processes the data for each wavelength by:\n\nSumming all radiance values for that wavelength.\nNormalizing the values so they represent a probability distribution.\nMultiplying this distribution by the total number of iterations (from amc.inp) to determine how many photons should be initiated from each specific sky patch.\n\n\n\n\nIt is not necessary for the wavelengths listed in this file to exactly match the simulation wavebands defined in lambbot.inp. The model does not interpolate the sky data. Instead, for each simulation waveband, the model performs a nearest-neighbor search. It identifies the single, numerically closest wavelength provided in skydist.inp and uses the complete sky radiance distribution from that single entry for the entire simulation run of that waveband.\nFor example, if skydist.inp contains data for 500nm and 600nm, and the simulation is running for wavebands at 520nm, 540nm, and 580nm:\n\nThe 520nm run will use the sky data for 500nm.\nThe 540nm run will also use the sky data for 500nm (since 540 is closer to 500 than to 600).\nThe 580nm run will use the sky data for 600nm.\n\n\n\n\nThe AOMC model expects input files to contain only the required numerical data in the correct order.\n\n\n\n\nBelow is a valid skydist.inp file, followed by an explanation of its contents.\nFile Content:\n6 2 2 2\n550.0 650.0\n1 1 0 10.5\n1 1 1 12.0\n1 2 1 20.0\n2 1 0 8.2\n2 1 1 9.5\n2 2 1 15.3\nExplanation of the Example:\n\nHeader Line (6 2 2 2):\n\n6: There are 6 radiance data lines to read in the data block.\n2: The sky is divided into 2 zenith bins (indexed 1 and 2).\n2: The sky is divided into 3 azimuth bins (indexed 0, 1, and 2).\n2: The file provides data for 2 different wavelengths.\n\nWavelengths Line (550.0 650.0):\n\nThe first wavelength (index=1) is 550.0.\nThe second wavelength (index=2) is 650.0.\n\nSky Radiance Data Block:\n\nThe line 1 1 0 10.5 corresponds to: Wavelength Index 1, Zenith Index 1, Azimuth Index 0, with a radiance value of 10.5.\nThe line 2 2 1 15.3 corresponds to: Wavelength Index 2, Zenith Index 2, Azimuth Index 1, with a radiance value of 15.3, and so on for all 6 lines."
  },
  {
    "objectID": "input_docs/skydist_inp.html#file-format",
    "href": "input_docs/skydist_inp.html#file-format",
    "title": "Tabulated Sky Radiance Input (skydist.inp)",
    "section": "",
    "text": "The skydist.inp file has a multi-part structure consisting of a header, a list of wavelengths, and a data block of radiance values. The file is read in free-format, meaning all numerical values should be separated by spaces or commas.\n\n\nThe very first line of the file must contain 4 integer values that define the dimensions of the sky data:\n\nnumskyelem: The total number of individual sky radiance data points that will be listed in the data block section of the file.\nsky_zenith: The number of zenith angle bins used in the sky distribution (i.e., the number of divisions from the horizon to the point directly overhead).\nsky_azimuth: The number of azimuthal angle bins. Note that the azimuth index in the data block will range from 0 to this value.\nnumskywave: The number of distinct wavelengths for which sky radiance data is provided.\n\n\n\n\nThe second line of the file must list the actual wavelength values. The number of values on this line must match the numskywave parameter from the header line.\n\n\n\nFollowing the first two lines, the remainder of the file consists of the sky radiance data points. The number of lines in this section must match the numskyelem parameter from the header line.\nEach line in this block represents a single sky “patch” or element and must contain 4 values:\n\nWavelength Index: An integer (1-based) that points to a wavelength in the Wavelengths Line. For example, a value of 1 corresponds to the first wavelength listed.\nZenith Index: An integer (1-based) specifying the zenith angle bin, from 1 to sky_zenith.\nAzimuth Index: An integer (0-based) specifying the azimuth angle bin, from 0 to sky_azimuth.\nRadiance Value: A floating-point number representing the radiance intensity for that specific sky patch.\n\nThis format allows for a sparse representation of the sky; you only need to provide entries for the sky patches that have non-zero radiance.\n\n\n\nAfter reading this file, the AOMC model processes the data for each wavelength by:\n\nSumming all radiance values for that wavelength.\nNormalizing the values so they represent a probability distribution.\nMultiplying this distribution by the total number of iterations (from amc.inp) to determine how many photons should be initiated from each specific sky patch.\n\n\n\n\nIt is not necessary for the wavelengths listed in this file to exactly match the simulation wavebands defined in lambbot.inp. The model does not interpolate the sky data. Instead, for each simulation waveband, the model performs a nearest-neighbor search. It identifies the single, numerically closest wavelength provided in skydist.inp and uses the complete sky radiance distribution from that single entry for the entire simulation run of that waveband.\nFor example, if skydist.inp contains data for 500nm and 600nm, and the simulation is running for wavebands at 520nm, 540nm, and 580nm:\n\nThe 520nm run will use the sky data for 500nm.\nThe 540nm run will also use the sky data for 500nm (since 540 is closer to 500 than to 600).\nThe 580nm run will use the sky data for 600nm.\n\n\n\n\nThe AOMC model expects input files to contain only the required numerical data in the correct order."
  },
  {
    "objectID": "input_docs/skydist_inp.html#example",
    "href": "input_docs/skydist_inp.html#example",
    "title": "Tabulated Sky Radiance Input (skydist.inp)",
    "section": "",
    "text": "Below is a valid skydist.inp file, followed by an explanation of its contents.\nFile Content:\n6 2 2 2\n550.0 650.0\n1 1 0 10.5\n1 1 1 12.0\n1 2 1 20.0\n2 1 0 8.2\n2 1 1 9.5\n2 2 1 15.3\nExplanation of the Example:\n\nHeader Line (6 2 2 2):\n\n6: There are 6 radiance data lines to read in the data block.\n2: The sky is divided into 2 zenith bins (indexed 1 and 2).\n2: The sky is divided into 3 azimuth bins (indexed 0, 1, and 2).\n2: The file provides data for 2 different wavelengths.\n\nWavelengths Line (550.0 650.0):\n\nThe first wavelength (index=1) is 550.0.\nThe second wavelength (index=2) is 650.0.\n\nSky Radiance Data Block:\n\nThe line 1 1 0 10.5 corresponds to: Wavelength Index 1, Zenith Index 1, Azimuth Index 0, with a radiance value of 10.5.\nThe line 2 2 1 15.3 corresponds to: Wavelength Index 2, Zenith Index 2, Azimuth Index 1, with a radiance value of 15.3, and so on for all 6 lines."
  },
  {
    "objectID": "input_docs/conc_inp.html",
    "href": "input_docs/conc_inp.html",
    "title": "Concentration Input Parameters (conc.inp)",
    "section": "",
    "text": "This document describes the format for the conc.inp file, which specifies the concentrations of various water quality constituents, the refractive index of the medium, and the top boundary depth for each defined layer in the AOMC model.\nThe weight units (e.g., grams, milligrams, micrograms) used for constituent concentrations in conc.inp must precisely match the weight units specified for the specific absorption coefficients in abs.inp and specific scattering coefficients in scat.inp. For example, \\(mg/m^3\\) or \\(g/m^3\\).\n\n\nThe structure of the conc.inp file is strict and must conform to the following rules for the model to parse it correctly:\n\nNumber of Layers: The very first value in the file must be an integer representing the total number of concentration-dependent layers. This number must match the value specified for parameter 13) # of concentration dependent layers in the amc.inp file.\nLayer Data: Following the number of layers, the file must contain one line of data for each layer. Each line comprises a series of floating-point values:\n\nConcentrations: A series of values representing the concentrations of each system constituent. The number of concentration values on each line must match the value specified for parameter 3) number of system constituents in the amc.inp file.\nRefractive Index: Immediately following the constituent concentrations, a single value representing the refractive index of the medium for that layer.\nTop Boundary Depth: Finally, a single value representing the depth of the top boundary of that layer.\n\nData Format: The numerical values are read in free-format (list-directed). This means the numbers should be separated by spaces or commas. They do not need to be aligned in fixed columns, as long as each line contains the correct total number of values ([number of constituents] + 2).\nAdditional Information: Any text or data placed after the layer data lines is ignored by the model. This space can be used for comments, notes, or metadata, as shown in the example below.\n\n\n\n\nHere is a sample conc.inp file configured for 2 layers and 3 system constituents.\n2\n1.0 0.05 0.01 1.340 0.0\n0.8 0.10 0.02 1.340 1.0\n\n--- NOTES ---\nThis NOTES section is not read by the AOMC model.\nEach line of data (after the first line) represents a layer.\nFor each layer, the values are:\n[Conc. Constituent 1] [Conc. Constituent 2] [Conc. Constituent 3] [Refractive Index] [Top Boundary Depth]\n\nDepths are in meters."
  },
  {
    "objectID": "input_docs/conc_inp.html#file-format",
    "href": "input_docs/conc_inp.html#file-format",
    "title": "Concentration Input Parameters (conc.inp)",
    "section": "",
    "text": "The structure of the conc.inp file is strict and must conform to the following rules for the model to parse it correctly:\n\nNumber of Layers: The very first value in the file must be an integer representing the total number of concentration-dependent layers. This number must match the value specified for parameter 13) # of concentration dependent layers in the amc.inp file.\nLayer Data: Following the number of layers, the file must contain one line of data for each layer. Each line comprises a series of floating-point values:\n\nConcentrations: A series of values representing the concentrations of each system constituent. The number of concentration values on each line must match the value specified for parameter 3) number of system constituents in the amc.inp file.\nRefractive Index: Immediately following the constituent concentrations, a single value representing the refractive index of the medium for that layer.\nTop Boundary Depth: Finally, a single value representing the depth of the top boundary of that layer.\n\nData Format: The numerical values are read in free-format (list-directed). This means the numbers should be separated by spaces or commas. They do not need to be aligned in fixed columns, as long as each line contains the correct total number of values ([number of constituents] + 2).\nAdditional Information: Any text or data placed after the layer data lines is ignored by the model. This space can be used for comments, notes, or metadata, as shown in the example below."
  },
  {
    "objectID": "input_docs/conc_inp.html#example",
    "href": "input_docs/conc_inp.html#example",
    "title": "Concentration Input Parameters (conc.inp)",
    "section": "",
    "text": "Here is a sample conc.inp file configured for 2 layers and 3 system constituents.\n2\n1.0 0.05 0.01 1.340 0.0\n0.8 0.10 0.02 1.340 1.0\n\n--- NOTES ---\nThis NOTES section is not read by the AOMC model.\nEach line of data (after the first line) represents a layer.\nFor each layer, the values are:\n[Conc. Constituent 1] [Conc. Constituent 2] [Conc. Constituent 3] [Refractive Index] [Top Boundary Depth]\n\nDepths are in meters."
  },
  {
    "objectID": "input_docs/spf_inp.html",
    "href": "input_docs/spf_inp.html",
    "title": "Scattering Phase Function Input (spf.inp)",
    "section": "",
    "text": "This document describes the format for the spf.inp file, which provides the cumulative scattering phase function (SPF) for each water constituent. This data determines the new direction of a photon after a scattering event.\n\n\nThe structure of the spf.inp file is as follows:\n\nNumber of Angles: The very first value must be an integer representing the number of angles in the phase function table. This number must match the value for parameter 12a) Number of angles in amc.inp.\nCumulative SPF Table: Following the first line, the file must contain one line for each angle. Each line is read in free-format (space- or comma-separated) and contains N+1 values, where N is the number of constituents (from amc.inp parameter 3):\n\nColumn 1: The scattering angle in radians.\nColumn 2 to N+1: The cumulative scattering probability for each constituent, from 0.0 to 1.0. Each column corresponds to a constituent in the same order they are defined elsewhere in the model.\n\n\n\n\n\nWhen a photon is scattered, the model uses the data from spf.inp to determine its new direction in a two-step process:\n\nSelect the Scattering Particle: First, the model randomly determines which type of particle (constituent) caused the scattering. This is based on the relative scattering contribution of each constituent at that wavelength.\nDetermine the New Angle: Once a particle is chosen, the model uses its corresponding cumulative SPF column as a probability lookup table to find the new scattering angle.\n\nA random number between 0 and 1 is generated.\nThe model finds where this random number would fit within the chosen constituent’s cumulative SPF column, identifying the two consecutive probability values it falls between.\nBy default, the model then assigns the discrete angle associated with the upper boundary of this probability interval. For example, if the random number falls between the probability for 0.1 radians and 0.2 radians, the new scattering angle will be set to 0.2 radians.\n\n\nNote on Interpolation: The vsf.f90 subroutine contains a commented-out (disabled) code block that would perform linear interpolation to calculate a more precise angle within the interval. However, this is not the default behavior. As a result, the slope values calculated when reading spf.inp are not used in the default configuration.\n\n\n\nHere is a sample spf.inp file configured for 5 angles and 2 system constituents.\n5\n0.000   0.000   0.000\n0.785   0.600   0.500\n1.571   0.800   0.750\n2.356   0.950   0.900\n3.142   1.000   1.000\n\n--- NOTES ---\nThis section is not read by the AOMC model.\nFormat: [Angle in Radians] [Constituent 1 Cum. SPF] [Constituent 2 Cum. SPF]"
  },
  {
    "objectID": "input_docs/spf_inp.html#file-format",
    "href": "input_docs/spf_inp.html#file-format",
    "title": "Scattering Phase Function Input (spf.inp)",
    "section": "",
    "text": "The structure of the spf.inp file is as follows:\n\nNumber of Angles: The very first value must be an integer representing the number of angles in the phase function table. This number must match the value for parameter 12a) Number of angles in amc.inp.\nCumulative SPF Table: Following the first line, the file must contain one line for each angle. Each line is read in free-format (space- or comma-separated) and contains N+1 values, where N is the number of constituents (from amc.inp parameter 3):\n\nColumn 1: The scattering angle in radians.\nColumn 2 to N+1: The cumulative scattering probability for each constituent, from 0.0 to 1.0. Each column corresponds to a constituent in the same order they are defined elsewhere in the model."
  },
  {
    "objectID": "input_docs/spf_inp.html#how-the-model-uses-this-file",
    "href": "input_docs/spf_inp.html#how-the-model-uses-this-file",
    "title": "Scattering Phase Function Input (spf.inp)",
    "section": "",
    "text": "When a photon is scattered, the model uses the data from spf.inp to determine its new direction in a two-step process:\n\nSelect the Scattering Particle: First, the model randomly determines which type of particle (constituent) caused the scattering. This is based on the relative scattering contribution of each constituent at that wavelength.\nDetermine the New Angle: Once a particle is chosen, the model uses its corresponding cumulative SPF column as a probability lookup table to find the new scattering angle.\n\nA random number between 0 and 1 is generated.\nThe model finds where this random number would fit within the chosen constituent’s cumulative SPF column, identifying the two consecutive probability values it falls between.\nBy default, the model then assigns the discrete angle associated with the upper boundary of this probability interval. For example, if the random number falls between the probability for 0.1 radians and 0.2 radians, the new scattering angle will be set to 0.2 radians.\n\n\nNote on Interpolation: The vsf.f90 subroutine contains a commented-out (disabled) code block that would perform linear interpolation to calculate a more precise angle within the interval. However, this is not the default behavior. As a result, the slope values calculated when reading spf.inp are not used in the default configuration."
  },
  {
    "objectID": "input_docs/spf_inp.html#example",
    "href": "input_docs/spf_inp.html#example",
    "title": "Scattering Phase Function Input (spf.inp)",
    "section": "",
    "text": "Here is a sample spf.inp file configured for 5 angles and 2 system constituents.\n5\n0.000   0.000   0.000\n0.785   0.600   0.500\n1.571   0.800   0.750\n2.356   0.950   0.900\n3.142   1.000   1.000\n\n--- NOTES ---\nThis section is not read by the AOMC model.\nFormat: [Angle in Radians] [Constituent 1 Cum. SPF] [Constituent 2 Cum. SPF]"
  },
  {
    "objectID": "input_docs/scat_inp.html",
    "href": "input_docs/scat_inp.html",
    "title": "Specific Scattering Coefficient Input Parameters (scat.inp)",
    "section": "",
    "text": "This document describes the format for the scat.inp file, which defines the wavelength-dependent specific scattering coefficients for the various water quality constituents simulated by the AOMC model. For consistent calculation of bulk optical properties, the specific scattering coefficients must be provided in units of \\(m^2/per\\ unit\\ of\\ weight\\) (e.g., \\(m^2/mg\\)). Therefore, it is crucial that the corresponding constituent concentrations in the conc.inp file are consistently recorded as the same weight per unit volume (e.g., \\(mg/m^3\\)).\n\n\nThe structure of the scat.inp file is strict and must conform to the following rules for the model to parse it correctly:\n\nNumber of Wavebands: The very first value in the file must be an integer representing the total number of wavebands. This number must match the value specified for parameter 18) Number of wavebands in the amc.inp file.\nScattering Coefficients: Following the number of wavebands, the file must contain a matrix of specific scattering coefficient values.\n\nRows: The number of rows in this matrix must match the number of wavebands declared on the first line.\nColumns: The number of columns must match the number of system constituents specified in parameter 3) number of system constituents in the amc.inp file. Each column represents a constituent (e.g., pure water, phytoplankton, non-algal particles, CDOM).\nData Format: The numerical values are read in free-format (list-directed). This means the numbers should be separated by spaces or commas. They do not need to be aligned in fixed columns, as long as each line contains the correct number of values.\n\nAdditional Information: Any text or data placed after the specific scattering coefficient matrix is ignored by the model. This space can be used for comments, notes, or metadata, as shown in the example below.\n\n\n\n\nHere is a sample scat.inp file configured for 12 wavebands and 3 system constituents.\n12\n0.020   0.50   0.10\n0.019   0.48   0.10\n0.018   0.45   0.10\n0.015   0.40   0.10\n0.012   0.35   0.09\n0.009   0.30   0.08\n0.007   0.25   0.07\n0.005   0.20   0.06\n0.003   0.15   0.05\n0.002   0.10   0.04\n0.001   0.08   0.03\n0.001   0.06   0.02\n\n--- NOTES ---\nThis section is not read by the AOMC model.\nThe columns represent the following constituents:\n1. Pure Water\n2. Phytoplankton\n3. Non-Algal Particles\nData sourced from internal lab measurements, 2023."
  },
  {
    "objectID": "input_docs/scat_inp.html#file-format",
    "href": "input_docs/scat_inp.html#file-format",
    "title": "Specific Scattering Coefficient Input Parameters (scat.inp)",
    "section": "",
    "text": "The structure of the scat.inp file is strict and must conform to the following rules for the model to parse it correctly:\n\nNumber of Wavebands: The very first value in the file must be an integer representing the total number of wavebands. This number must match the value specified for parameter 18) Number of wavebands in the amc.inp file.\nScattering Coefficients: Following the number of wavebands, the file must contain a matrix of specific scattering coefficient values.\n\nRows: The number of rows in this matrix must match the number of wavebands declared on the first line.\nColumns: The number of columns must match the number of system constituents specified in parameter 3) number of system constituents in the amc.inp file. Each column represents a constituent (e.g., pure water, phytoplankton, non-algal particles, CDOM).\nData Format: The numerical values are read in free-format (list-directed). This means the numbers should be separated by spaces or commas. They do not need to be aligned in fixed columns, as long as each line contains the correct number of values.\n\nAdditional Information: Any text or data placed after the specific scattering coefficient matrix is ignored by the model. This space can be used for comments, notes, or metadata, as shown in the example below."
  },
  {
    "objectID": "input_docs/scat_inp.html#example",
    "href": "input_docs/scat_inp.html#example",
    "title": "Specific Scattering Coefficient Input Parameters (scat.inp)",
    "section": "",
    "text": "Here is a sample scat.inp file configured for 12 wavebands and 3 system constituents.\n12\n0.020   0.50   0.10\n0.019   0.48   0.10\n0.018   0.45   0.10\n0.015   0.40   0.10\n0.012   0.35   0.09\n0.009   0.30   0.08\n0.007   0.25   0.07\n0.005   0.20   0.06\n0.003   0.15   0.05\n0.002   0.10   0.04\n0.001   0.08   0.03\n0.001   0.06   0.02\n\n--- NOTES ---\nThis section is not read by the AOMC model.\nThe columns represent the following constituents:\n1. Pure Water\n2. Phytoplankton\n3. Non-Algal Particles\nData sourced from internal lab measurements, 2023."
  },
  {
    "objectID": "input_docs/lambbot_inp.html",
    "href": "input_docs/lambbot_inp.html",
    "title": "Wavelength and Bottom Reflectance Input (lambbot.inp)",
    "section": "",
    "text": "This document describes the format for the lambbot.inp file. This file is crucial for defining the simulation’s wavebands and the reflective properties of the bottom boundary (and an optional target).\n\n\nThe structure of the lambbot.inp file depends on whether a bottom target is enabled via parameter 16) Bottom target: NO[0],YES[1] in the amc.inp file.\nThe data is read in free-format (list-directed), meaning numerical values should be separated by spaces or commas.\n\n\nIf no target is specified, the file has the following structure:\n\nFirst Line: An integer representing the total number of wavebands. This must match parameter 18) Number of wavebands in amc.inp.\nSubsequent Lines: One line for each waveband, containing 3 values:\n\nWavelength: The actual wavelength value (e.g., in nanometers).\nBottom Reflectance: The fraction of photons that are reflected by the bottom boundary (a value from 0.0 to 1.0).\nBottom Specular Fraction: The fraction of the reflected photons that are reflected specularly (mirror-like). A value of 1.0 is purely specular, 0.0 is purely diffuse (Lambertian).\n\n\n\n\n\nIf a target is specified, the file requires additional information:\n\nFirst Line: An integer representing the total number of wavebands (must match amc.inp).\nSubsequent Lines: One line for each waveband, containing 5 values:\n\nWavelength: The actual wavelength value.\nBottom Reflectance: Reflectance of the general bottom area (outside the target).\nBottom Specular Fraction: Specular fraction for the general bottom.\nTarget Reflectance: Reflectance of the target area.\nTarget Specular Fraction: Specular fraction for the target.\n\n\n\n\n\n\nWhen a photon strikes the bottom boundary, the model determines its fate using the parameters from this file in a two-step process:\n\nReflection vs. Absorption: A random number (from 0 to 1) is generated. If this number is less than or equal to the surface’s Reflectance value (e.g., Bottom Reflectance), the photon is reflected. Otherwise, it is absorbed.\nSpecular vs. Diffuse: If the photon is reflected, a second random number is generated.\n\nIf this second random number is less than or equal to the surface’s Specular Fraction value (e.g., Bottom Specular Fraction), the reflection is specular (mirror-like), and the photon’s angle of incidence is perfectly inverted.\nIf the random number is greater than the Specular Fraction, the reflection is diffuse (Lambertian), and the photon is scattered in a new, random upward direction.\n\n\n\n\n\n\n\nHere is a sample lambbot.inp for 4 wavebands without a bottom target.\n4\n400.0   0.10   0.5\n500.0   0.15   0.4\n600.0   0.20   0.3\n700.0   0.25   0.2\n\n--- NOTES ---\nThis section is not read by the model.\nFormat: [Wavelength] [Bottom Reflectance] [Bottom Specular Fraction]\n\n\n\nHere is a sample lambbot.inp for 4 wavebands with a bottom target enabled.\n4\n400.0   0.10   0.5   0.8   1.0\n500.0   0.15   0.4   0.7   0.9\n600.0   0.20   0.3   0.6   0.8\n700.0   0.25   0.2   0.5   0.7\n\n--- NOTES ---\nThis section is not read by the model.\nFormat: [Wavelength] [Bottom Reflectance] [Bottom Specular] [Target Reflectance] [Target Specular]"
  },
  {
    "objectID": "input_docs/lambbot_inp.html#file-format",
    "href": "input_docs/lambbot_inp.html#file-format",
    "title": "Wavelength and Bottom Reflectance Input (lambbot.inp)",
    "section": "",
    "text": "The structure of the lambbot.inp file depends on whether a bottom target is enabled via parameter 16) Bottom target: NO[0],YES[1] in the amc.inp file.\nThe data is read in free-format (list-directed), meaning numerical values should be separated by spaces or commas.\n\n\nIf no target is specified, the file has the following structure:\n\nFirst Line: An integer representing the total number of wavebands. This must match parameter 18) Number of wavebands in amc.inp.\nSubsequent Lines: One line for each waveband, containing 3 values:\n\nWavelength: The actual wavelength value (e.g., in nanometers).\nBottom Reflectance: The fraction of photons that are reflected by the bottom boundary (a value from 0.0 to 1.0).\nBottom Specular Fraction: The fraction of the reflected photons that are reflected specularly (mirror-like). A value of 1.0 is purely specular, 0.0 is purely diffuse (Lambertian).\n\n\n\n\n\nIf a target is specified, the file requires additional information:\n\nFirst Line: An integer representing the total number of wavebands (must match amc.inp).\nSubsequent Lines: One line for each waveband, containing 5 values:\n\nWavelength: The actual wavelength value.\nBottom Reflectance: Reflectance of the general bottom area (outside the target).\nBottom Specular Fraction: Specular fraction for the general bottom.\nTarget Reflectance: Reflectance of the target area.\nTarget Specular Fraction: Specular fraction for the target."
  },
  {
    "objectID": "input_docs/lambbot_inp.html#specular-vs.-diffuse-reflection-logic",
    "href": "input_docs/lambbot_inp.html#specular-vs.-diffuse-reflection-logic",
    "title": "Wavelength and Bottom Reflectance Input (lambbot.inp)",
    "section": "",
    "text": "When a photon strikes the bottom boundary, the model determines its fate using the parameters from this file in a two-step process:\n\nReflection vs. Absorption: A random number (from 0 to 1) is generated. If this number is less than or equal to the surface’s Reflectance value (e.g., Bottom Reflectance), the photon is reflected. Otherwise, it is absorbed.\nSpecular vs. Diffuse: If the photon is reflected, a second random number is generated.\n\nIf this second random number is less than or equal to the surface’s Specular Fraction value (e.g., Bottom Specular Fraction), the reflection is specular (mirror-like), and the photon’s angle of incidence is perfectly inverted.\nIf the random number is greater than the Specular Fraction, the reflection is diffuse (Lambertian), and the photon is scattered in a new, random upward direction."
  },
  {
    "objectID": "input_docs/lambbot_inp.html#examples",
    "href": "input_docs/lambbot_inp.html#examples",
    "title": "Wavelength and Bottom Reflectance Input (lambbot.inp)",
    "section": "",
    "text": "Here is a sample lambbot.inp for 4 wavebands without a bottom target.\n4\n400.0   0.10   0.5\n500.0   0.15   0.4\n600.0   0.20   0.3\n700.0   0.25   0.2\n\n--- NOTES ---\nThis section is not read by the model.\nFormat: [Wavelength] [Bottom Reflectance] [Bottom Specular Fraction]\n\n\n\nHere is a sample lambbot.inp for 4 wavebands with a bottom target enabled.\n4\n400.0   0.10   0.5   0.8   1.0\n500.0   0.15   0.4   0.7   0.9\n600.0   0.20   0.3   0.6   0.8\n700.0   0.25   0.2   0.5   0.7\n\n--- NOTES ---\nThis section is not read by the model.\nFormat: [Wavelength] [Bottom Reflectance] [Bottom Specular] [Target Reflectance] [Target Specular]"
  }
]